<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Securing Verifiable Credentials using JOSE and COSE</title>
  <script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove"></script>
  <script src="https://cdn.jsdelivr.net/gh/w3c/vc-jose-cose@fix-examples/plugin/dist/main.js"></script>
  <script class="remove">
    // See https://github.com/w3c/respec/wiki/ for how to configure
    // ReSpec
    var respecConfig = {
      group: "vc",

      // specification status (e.g., WD, NOTE, etc.). If in doubt use
      // ED.
      specStatus: "WD",

      // the specification's short name, as in
      // http://www.w3.org/TR/short-name/
      shortName: "vc-jose-cose",

      // if you wish the publication date to be other than today, set
      // this
      // publishDate: "2023-07-20",

      // implementationReportURI:
      // "https://w3c.github.io/vc-test-suite/implementations/", errata:
      // "https://w3c.github.io/vc-data-model/errata.html",
      // previousMaturity: "REC", previousPublishDate: "2019-11-19",

      // if there is a previously published draft, uncomment this and
      // set its YYYY-MM-DD date and its maturity status
      previousPublishDate:  "2023-07-10",
      previousMaturity:  "WD",

      // extend the bibliography entries localBiblio: vcwg.localBiblio,
      doJsonLd: true,

      // Uncomment these to use the respec extension that generates a
      //   list of normative statements: preProcess: [], postProcess:
      //   [],

      github: "https://github.com/w3c/vc-jose-cose/",
      includePermalinks: false,

      // if there a publicly available Editor's Draft, this is the link
      edDraftURI: "https://w3c.github.io/vc-jose-cose/",

      // editors, add as many as you like only "name" is required
      editors: [
        {
          name: "Michael Jones",
          url: "https://self-issued.info/",
          company: "Self-Issued Consulting",
          w3cid: 38745,
        },
        {
          name: "Michael Prorock",
          company: "Mesur.io", companyURL: "https://mesur.io/",
          w3cid: 130636
        },
        {
          name: "Gabe Cohen",
          url: "https://github.com/decentralgabe",
          company: "Block",
          companyURL: "https://www.tbd.website",
          w3cid: 116851
        }
      ],
      // authors, add as many as you like. This is optional, uncomment
      // if you have authors as well as editors. only "name" is
      // required. Same format as editors.
      authors: [],
      formerEditors: [{
          name: "Orie Steele",
          company: "Transmute",
          companyURL: "https://transmute.industries",
          w3cid: 109171,
        }],

      maxTocLevel: 3,
      inlineCSS: true,
      postProcess: [window.respecVcJoseCose.processVcJoseCose],
      license: "w3c-software-doc",
      xref: true,
      otherLinks: [{
        key: "Related Documents",
        data: [{
          value: "VC Data Model",
          href: "https://www.w3.org/TR/vc-data-model-2.0/"
        }, {
          value: "DID Core",
          href: "https://www.w3.org/TR/did-core/"
        }]
      }],
      localBiblio:  {
        "SD-JWT": {
          title:    "Selective Disclosure for JWTs (SD-JWT)",
          href:     "https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt",
          authors:  [ "Daniel Fett" , "Kristina Yasuda" , "Brian Campbell"],
          status:   "Internet-Draft",
          publisher:  "IETF"
        },
        "COSE-Sign-1": {
          title:    "CBOR Object Signing and Encryption (COSE): Structures and Process",
          href:     "https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt",
          authors:  [ "Jim Schaad" ],
          status:   "Internet Standard",
          publisher:  "IETF"
        },
        "SD-JWT-VC": {
          title:    "SD-JWT-based Verifiable Credentials (SD-JWT VC)",
          href:     "https://datatracker.ietf.org/doc/html/draft-ietf-oauth-sd-jwt-vc",
          authors:  [ "Oliver Terbu", "Daniel Fett", "Brian Campbell" ],
          status:   "Internet-Draft",
          publisher:  "IETF"
        },
        "MULTIPLE-SUFFIXES": {
          title:    "Media Types with Multiple Suffixes",
          href:     "https://datatracker.ietf.org/doc/draft-ietf-mediaman-suffixes/",
          authors:  [   "Manu Sporny" , "Amy Guy" ],
          status:   "Internet-Draft",
          publisher:  "IETF"
        },
        "JOSE-REGISTRIES": {
          title:    "The JSON Object Signing and Encryption (JOSE) Registries",
          href:     "https://www.iana.org/assignments/jose",
          authors:  ["The Internet Assigned Numbers Authority"],
          status:   "REC",
          publisher:  "The Internet Assigned Numbers Authority"
        },
      }
    };
  </script>
</head>

<body>
  <section id="abstract">
    <p>
      This specification defines how to secure credentials and presentations
      conforming to the Verifiable Credential data model [[VC-DATA-MODEL-2.0]]
      with JSON Object Signing and Encryption (<a href="https://datatracker.ietf.org/wg/jose/about/">JOSE</a>)
      and CBOR Object Signing and Encryption (COSE) [[RFC9052]].
      This enables the Verifiable Credential data model
      [[VC-DATA-MODEL-2.0]] to be implemented with standards
      for signing and encryption that are widely adopted.
    </p>
  </section>
  <section id="sotd"></section>

  <section id="introduction">
    <h2>Introduction</h2>
    <p>
      This specification describes how to secure media types
      expressing Verifiable Credentials and Verifiable Presentations
      as described in [[VC-DATA-MODEL-2.0]] using approaches
      defined by the OAuth, JOSE, and COSE working groups at the IETF.
      This includes SD-JWT [[SD-JWT]] and COSE [[RFC9052]],
      and provides an approach using well-defined content types
      [[RFC6838]] and structured suffixes [[MULTIPLE-SUFFIXES]]
      to distinguish the data types of unsecured documents conforming to [[VC-DATA-MODEL-2.0]]
      from the data types of secured documents conforming to [[VC-DATA-MODEL-2.0]],
      as defined in this specification.
    </p>
    <p>
      Selective Disclosure for JWTs (SD-JWT) [[SD-JWT]] provides a standardized
      mechanism for digitally signing JSON documents. It provides a means
      to ensure the integrity, authenticity, selective disclosure and non-repudiation of
      the information contained in a JSON document. These
      properties make SD-JWT especially well suited to securing documents
      conforming to the JSON-LD [[VC-DATA-MODEL-2.0]].
    </p>
    <p>
      CBOR Object Signing and Encryption (COSE) [[RFC9052]] is a
      specification that defines a framework for representing signed and
      encrypted data using (Concise Binary Object Representation) [RFC8949]
      data structures. COSE provides a standardized way to secure the
      integrity, authenticity, and confidentiality of CBOR-encoded
      information. It offers a flexible and extensible set of
      cryptographic options, allowing for a wide range of algorithms
      to be used for signing and encryption.

      COSE supports two main operations: signing and encryption. For
      signing, COSE allows the creation of digital signatures over
      CBOR data using various algorithms such as HMAC, RSA, ECDSA, or
      EdDSA. These signatures provide assurance of data integrity and
      authenticity. COSE also supports encryption, enabling the
      confidentiality of CBOR data by encrypting it with symmetric or
      asymmetric encryption algorithms.
    </p>
  </section>

  <section>
    <h3>Terminology</h3>
    <div data-include="./terms.html"></div>
  </section>

  <section>
    <h2>Securing the VC Data Model</h2>
    <p>
      This section outlines how to secure documents conforming
      to [[VC-DATA-MODEL-2.0]] using JOSE and COSE.
    </p>
    <p>
      Documents conforming to [[VC-DATA-MODEL-2.0]],
      and their associated media types, rely on
      JSON-LD, which is an extensible format for describing
      linked data; see <a href="https://www.w3.org/TR/json-ld11/#relationship-to-rdf">JSON-LD Relationship to RDF</a>.
    </p>
    <p>
      A benefit to this approach is that payloads can be made to conform
      directly to [[VC-DATA-MODEL-2.0]] without any mappings or
      transformation, while at the same time supporting registered
      header parameters and claims that are understood in the context of JOSE and COSE.
    </p>
    <p>
      It is RECOMMENDED that media types be used to distinguish <a data-cite="VC-DATA-MODEL-2.0#credentials">verifiable credentials</a>
      and <a data-cite="VC-DATA-MODEL-2.0#presentations">verifiable presentations</a> from other kinds of secured JSON or CBOR.
    </p>
    <p>
      The most specific media type (or subtype) available SHOULD be used, instead of
      more generic media types (or supertypes). For example, rather than the general
      <code>application/sd-jwt</code>, <code>application/vc+ld+json+sd-jwt</code>
      ought to be used, unless there is a more specific media type that would even
      better identify the secured envelope format.
    </p>
    <p>
    If implementations do not know which media type to use, media types defined in this specification MUST be used.
    </p>
    <section>
      <h2>With JOSE</h2>
      <section>
        <h2>Securing JSON-LD Verifiable Credentials with JOSE</h2>
        <p>
          This section details how to use JOSE to secure verifiable credentials conforming
          to [[VC-DATA-MODEL-2.0]].
        </p>
        <p>
          [[RFC7515]] MAY be used to secure this media type.
          The <code>typ</code> header parameter SHOULD be <code>vc+ld+json+sd-jwt</code>.
          When present, the <code>cty</code> header parameter SHOULD be <code>vc+ld+json</code>.
          See <a data-cite="RFC7515#section-4.1">Registered Header Parameter Names</a>
          for additional details regarding usage of <code>typ</code> and
          <code>cty</code>.
        </p>

        <pre class="example vc-jose-cose" title="A simple example of a verifiable credential">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "http://university.example/credentials/1872",
  "type": [
    "VerifiableCredential",
    "ExampleAlumniCredential"
  ],
  "issuer": "https://university.example/issuers/565049",
  "validFrom": "2010-01-01T19:23:24Z",
  "credentialSchema": {
    "id": "https://example.org/examples/degree.json",
    "type": "JsonSchema"
  },
  "credentialSubject": {
    "id": "did:example:123",
    "degree": {
      "type": "BachelorDegree",
      "name": "Bachelor of Science and Arts"
    }
  }
}
        </pre>
        <p>
          See <a data-cite="VC-DATA-MODEL-2.0#example-a-simple-example-of-a-verifiable-credential"></a> for more details regarding this example.
        </p>
      </section>

      <section>
        <h2>Securing JSON-LD Verifiable Presentations with JOSE</h2>
        <p>
          This section details how to use JOSE to secure verifiable presentations conforming
          to [[VC-DATA-MODEL-2.0]].
        </p>
        <p>
          [[RFC7515]] MAY be used to secure this media type.
          The <code>typ</code> header parameter SHOULD be <code>vp+ld+json+sd-jwt</code>.
    When present, the <code>cty</code> header parameter SHOULD be <code>vp+ld+json</code>.
          See <a data-cite="RFC7515#section-4.1">Registered Header Parameter Names</a>
          for additional details regarding usage of <code>typ</code> and
          <code>cty</code>.
        </p>
        <p>
          Credentials in verifiable presentations MUST use the <a data-cite="VC-DATA-MODEL-2.0/#defn-EnvelopedVerifiableCredential">Enveloped Verifiable Credential</a>
          type defined by the [[VC-DATA-MODEL-2.0]].
        </p>
        <p>
          Credentials in verifiable presentations MUST be secured. These credentials MAY
          be secured using JOSE.
        <p>

    <pre class="example vc-jose-cose" title="A simple example of a verifiable presentation">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "type": "VerifiablePresentation",
  "verifiableCredential": [{
    "@context": ["https://www.w3.org/ns/credentials/v2"],
    "type": ["EnvelopedVerifiableCredential"],
    "id": "data:application/vc+ld+json+sd-jwt;eyJhbGciOiJFUzM4NCIsImtpZCI6IlVRTV9fblE0UzZCTzhuUTRuT05YeHB4aHRob3lOeGI1M0xZZ1l6LTJBQnMiLCJ0eXAiOiJ2cCtsZCtqc29uK3NkLWp3dCIsImN0eSI6InZwK2xkK2pzb24ifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwidmVyaWZpYWJsZUNyZWRlbnRpYWwiOlt7IkBjb250ZXh0IjpbImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy92MiIsImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy9leGFtcGxlcy92MiJdLCJpc3N1ZXIiOiJodHRwczovL3VuaXZlcnNpdHkuZXhhbXBsZS9pc3N1ZXJzLzU2NTA0OSIsInZhbGlkRnJvbSI6IjIwMTAtMDEtMDFUMTk6MjM6MjRaIiwiY3JlZGVudGlhbFN1YmplY3QiOnsiYWx1bW5pT2YiOnsibmFtZSI6IkV4YW1wbGUgVW5pdmVyc2l0eSIsIl9zZCI6WyJoek9LRzU2cDI5c1ByTGFDNUE4RndFdUczVU05dUlZU1p1cU9YczJlVGJBIl19LCJfc2QiOlsiWVdXVmVDRndxQmk4WDBqSF9jV0NWWU16STNhOHBjTEVYRWZicFNSQVlndyJdfSwiX3NkIjpbIjJJZjhhaUs4REZwVWJ4dEc1cGMwel9SaFJzbm1ybGFRMEhzcTk4WFNyYWsiLCJUeDZ4ZWZMVUdUZUpfYWtVUFdGeHNvbUhobGtWVnpfNzVoaVZ6eWpyYmVzIl19XSwiX3NkIjpbIjd2anl0VVN3ZEJ0MXQ5RktlOVFfS3JIRXhFWGxrTEFaTzBKM0Jpd200dlkiXSwiX3NkX2FsZyI6InNoYS0yNTYiLCJpYXQiOjE3MDY1NjI4NDksImV4cCI6MTczODE4NTI0OSwiY25mIjp7Imp3ayI6eyJrdHkiOiJFQyIsImNydiI6IlAtMzg0IiwiYWxnIjoiRVMzODQiLCJ4IjoidWtEd1U2ZzlQUVRFUWhYaEgyckRZNndMQlg3UHFlUjZBcGlhVHBEUXowcl8tdDl6UXNxem54Z0hEcE5oekZlQyIsInkiOiJMQnhVYnBVdFNGMVVKVTVpYnJIdkpINjBUSG5YMk1xa0xHZGltU1l0UGR4RlkxOEdhcldiS3FZV0djUkZHVE9BIn19fQ.kYD63YtBNYnLUTw6Szf1vs_Ug3UBXhPwCyqpNmPnPDa3rXZQhQLdB1BgaoO8zgQ-c3B41fxaXMnLHYV9-B20uboSpJP0B-2Vre917eQt1cSDswDGA_Ytvn4BSqYVBB2J~WyJFMkFsRzhsY2p0QVFrcllIbjlIbnVRIiwgInR5cGUiLCAiVmVyaWZpYWJsZVByZXNlbnRhdGlvbiJd~WyI5NldYMDRneno4cVZzOVZLU2wwYTVnIiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~WyJaekU2VFVaamtHMW1DWXBKMEhnc0l3IiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyItQ3NsS25GZGFYb2JiQWsyU0JBVGR3IiwgImlkIiwgImRpZDpleGFtcGxlOmViZmViMWY3MTJlYmM2ZjFjMjc2ZTEyZWMyMSJd~WyJuRm1OWl9IczB3WWNoOFdkeTdnQUNRIiwgImlkIiwgImRpZDpleGFtcGxlOmMyNzZlMTJlYzIxZWJmZWIxZjcxMmViYzZmMSJd"
  }]
}
      </pre>
      <p>
        See <a data-cite="VC-DATA-MODEL-2.0#example-a-simple-example-of-a-verifiable-presentation"></a> for more details regarding this example.
      </p>

      <p>
To improve interoperability, implementations SHOULD support the compact serialization (<code>application/sd-jwt</code>),
and MAY support the JSON serialization (<code>application/sd-jwt+json</code>).
If the JSON serialization is used, it is RECOMMENDED that a profile be defined,
to ensure any addition JSON members are understood consistently.
      </p>
      </section>
    </section>
    <section>
      <h2>With COSE</h2>
      <p>
        COSE [[RFC9052]] is a common approach to encoding and securing
        information using CBOR [[RFC8949]]. Verifiable credentials MAY
        be secured using COSE [[RFC9052]] and SHOULD be identified through
        use of content types as outlined in this section.
      </p>

      <section>
        <h2>Securing JSON-LD Verifiable Credentials with COSE</h2>
        <p>
          This section details how to secure data with the type
          <code>application/vc+ld+json</code>
          with COSE.
        </p>
        <p>
          [[RFC9052]] MAY be used to secure this media type.
          The <code>typ</code> header parameter SHOULD be <code>application/vc+ld+json+cose</code>.
          See <a href="https://www.ietf.org/archive/id/draft-ietf-cose-typ-header-parameter-01.html">I-D.ietf-cose-typ-header-parameter</a>
          for the COSE "<code>typ</code>" (type) header parameter.
          When present, the <code>content type (3)</code> header parameter
          SHOULD be <code>application/vc+ld+json</code>.
          See <a data-cite="RFC9052#section-3.1">Common COSE Header Parameters</a> for additional details.
        </p>
      </section>

      <section>
        <h2>Securing JSON-LD Verifiable Presentations with COSE</h2>
        <p>
          This section details how to use COSE to secure verifiable presentations conforming
          to [[VC-DATA-MODEL-2.0]].
        </p>
        <p>
          [[RFC9052]] MAY be used to secure this media type.
          The <code>typ</code> header parameter SHOULD be <code>application/vp+ld+json+sd-jwt</code>.
          When present, the <code>cty</code> header parameter SHOULD be <code>application/vp+ld+json</code>.
          See <a data-cite="RFC9052#section-3.1">Common COSE Header Parameters</a> for additional details.
        </p>
        <p>
          Credentials in verifiable presentations MUST use the <a data-cite="VC-DATA-MODEL-2.0/#defn-EnvelopedVerifiableCredential">Enveloped Verifiable Credential</a>
          type defined by the [[VC-DATA-MODEL-2.0]].
        </p>
        <p>
          Credentials in verifiable presentations MUST be secured. These credentials MAY
          be secured using COSE.
        <p>

    </section>
  </section>

    <section class="normative">
      <h2>JOSE Header Parameters and JWT Claims</h2>

      <p>
      When present in
      the <a data-cite="RFC7515#section-4">JOSE Header</a> or
      the <a data-cite="RFC7519#section-4">JWT Claims Set</a>,
      members registered in
      the IANA <a href="https://www.iana.org/assignments/jwt/jwt.xhtml">JSON Web Token Claims</a> registry or
      the IANA <a href="https://www.iana.org/assignments/jose/jose.xhtml">JSON Web Signature and Encryption Header Parameters</a> registry
      are to be interpreted as defined by the specifications referenced in the registries.
      </p>
      <p>
        The normative statements in
  <a data-cite="RFC7515#section-4.1">Registered Header Parameter Names</a>,
        <a data-cite="RFC7519#section-5">JOSE Header</a>, and
  <a data-cite="RFC7519#section-5.3">Replicating Claims as Header Parameters</a>
        apply to securing credentials and presentations.
      </p>
      <p>
        The unencoded JOSE Header is JSON
        (`application/json`), not JSON-LD (`application/ld+json`).
      </p>
      <p>
        It is RECOMMENDED to use
  the IANA <a href="https://www.iana.org/assignments/jwt/jwt.xhtml">JSON Web Token Claims</a> registry and
  the IANA <a href="https://www.iana.org/assignments/jose/jose.xhtml">JSON Web Signature and Encryption Header Parameters</a> registry
        to identify any claims and header parameters that might be confused with
        members defined by [[VC-DATA-MODEL-2.0]]. These include but are not
        limited to: <code>iss</code>, <code>kid</code>,
        <code>alg</code>, <code>iat</code>,
        <code>exp</code>, and <code>cnf</code>.
      </p>
      <p>
        When the <code>iat</code> and/or <code>exp</code> JWT claims are present,
        they represent the issuance and expiration time of the signature, respectively.
        Note that these are different from the <code>validFrom</code> and <code>validUntil</code> properties
        defined in <a data-cite="VC-DATA-MODEL-2.0#validity-period">Validity Period</a>,
        which represent the validity of the data that is being secured.
      </p>
      <p>
        The claims and security provided by this specification are independent of the data
        secured and semantics provided by the [[VC-DATA-MODEL-2.0]]. This means that while the security
        features of this specification ensure data integrity and authenticity, they do
        not dictate the interpretation of claim data.
      </p>
      <p>
        Implementers SHOULD avoid setting JWT claims to values that conflict with
        verifiable credential properties, especially with pairs such as
        `iss` and `issuer`, `jti` and `id`, and `sub` and `credentialSubject.id`.
      </p>
      <p>
        The JWT Claim Names <code>vc</code> and <code>vp</code>
        MUST NOT be present.
      </p>
      <p>
        Additional members may be present as header parameters and claims.
        If they are not understood, they MUST be ignored.
      </p>
    </section>
  </section>

    <section class="normative">
      <h2>COSE Header Parameters and CWT Claims</h2>

      <p>
      When present in
      the <a data-cite="RFC9052#section-3.1">COSE Header</a> or
      as <a data-cite="RFC8392#section-3">CWT Claims</a>,
      members registered in
      the IANA <a href="https://www.iana.org/assignments/cwt/cwt.xhtml">CBOR Web Token (CWT) Claims</a> registry or
      the IANA <a href="https://www.iana.org/assignments/cose/cose.xhtml">COSE Header Parameters</a> registry
      are to be interpreted as defined by the specifications referenced in the registries.
      CWT Claims MAY be included in a COSE header parameter, as specified in
      <a href="https://www.ietf.org/archive/id/draft-ietf-cose-cwt-claims-in-headers-09.html">I-D.ietf-cose-cwt-claims-in-headers</a>.
      </p>
      <p>
        The normative statements in
  <a data-cite="RFC9052#section-3.1.1">Registered Header Parameter Names</a>,
        <a data-cite="RFC8392#section-3">Claims</a>, and
  <a href="https://www.ietf.org/archive/id/draft-ietf-cose-cwt-claims-in-headers-09.html">CBOR Web Token (CWT) Claims in COSE Headers</a>
        apply to securing credentials and presentations.
      </p>
      <p>
        It is RECOMMENDED to use
  the IANA <a href="https://www.iana.org/assignments/cwt/cwt.xhtml">CBOR Web Token Claims</a> registry and
  the IANA <a href="https://www.iana.org/assignments/cose/cose.xhtml">COSE Header Parameters</a> registry
        to identify any claims and header parameters that might be confused with
        members defined by [[VC-DATA-MODEL-2.0]]. These include but are not
        limited to: <code>iss</code>, <code>kid</code>,
        <code>alg</code>, <code>iat</code>,
        <code>exp</code>, and <code>cnf</code>.
      </p>
      <p>
        When the <code>iat</code> and/or <code>exp</code> CWT claims are present,
        they represent the issuance and expiration time of the signature, respectively.
        Note that these are different from the <code>validFrom</code> and <code>validUntil</code> properties
        defined in <a data-cite="VC-DATA-MODEL-2.0#validity-period">Validity Period</a>,
        which represent the validity of the data that is being secured.
      </p>
      <p>
        Additional members may be present as header parameters and claims.
  If they are not understood, they MUST be ignored.
      </p>
    </section>
  </section>

  <section id="key_discovery" class="normative">
    <h2>Key Discovery</h2>
      <p class="issue" data-number="160">
        The working group is still discussing how to close many related issues.
      </p>

      <!-- DID URLS via "issuer" and "holder" -->
      <p>
        When <a href="#iss">iss</a> is absent and the <a data-cite="VC-DATA-MODEL-2.0#dfn-issuers">issuer</a>
        is identified as a <a data-cite="DID-CORE#did-subject">DID Subject</a>,
        the <a href="#kid">kid</a> MUST be an absolute <a data-cite="DID-CORE#relative-did-urls">DID URL</a>.
      </p>
<pre class="example" title="An issuer identified by a DID">
{
  "issuer": "did:example:123"
  // ...
}
</pre>
<pre class="example" title="An absolute DID URL as a kid">
{
  "alg": "ES384",
  "kid": "did:example:123#key-456
}
</pre>
      <p>
        When <a href="#iss">iss</a> is absent, and the <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">holder</a>
        is identified as a <a data-cite="DID-CORE#did-subject">DID Subject</a>,
        the <a href="#kid">kid</a> MUST be an absolute <a data-cite="DID-CORE#relative-did-urls">DID URL</a>.
      </p>
<pre class="example" title="A holder identified by a DID">
{
  "holder": "did:example:abc"
  // ...
}
</pre>
<pre class="example" title="A kid as an absolute DID URL">
{
  "alg": "ES384",
  "kid": "did:example:abc#key-456
}
</pre>

      <!-- REGULAR URLS via "issuer" and "holder" -->
      <p>
        When <a href="#iss">iss</a> is absent, and the <a data-cite="VC-DATA-MODEL-2.0#dfn-issuers">issuer</a> is identified as a [[URL]],
        the <a href="#kid">kid</a> MUST be an absolute [[URL]] to a verification method listed in a controller document.
      </p>

<pre class="example" title="An issuer identified by a controller document identifier">
{
  "issuer": {
    "id": "https://university.example/issuers/565049"
  }
  // ...
}
</pre>
<pre class="example" title="A kid as a controller document verification method identifier">
{
  "alg": "ES384",
  "kid": "https://university.example/issuers/565049#key-123
}
</pre>

      <p>
        When the <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">holder</a> is identified as a [[URL]],
        and <a href="#iss">iss</a> is absent,
        the <a href="#kid">kid</a> MUST be an absolute [[URL]] to a verification method listed in a controller document.
      </p>
<pre class="example" title="A holder identified by a controller document identifier">
{
  "holder": {
    "id": "https://university.example/issuers/565049"
  }
  // ...
}
</pre>
<pre class="example" title="A kid as a controller document verification method identifier">
{
  "alg": "ES384",
  "kid": "https://university.example/issuers/565049#key-123
}
</pre>

      <!-- REGULAR URLS via "iss" -->

      <p>
        When <a href="#iss">iss</a> is present and is a [[URL]],
        the <a href="#kid">kid</a> MUST match a key discovered via a JWT Issuer Metadata Request,
  as described in [[SD-JWT-VC]].
      </p>

      <p class="issue" title="(AT RISK) Feature depends on demonstration of independent implementations" data-number="160">
        This normative statement depends on the IETF OAUTH working group adopted draft [[SD-JWT-VC]].
        This feature is at risk and will be removed from the specification if at least
        two independent, interoperable implementations are not demonstrated.
      </p>

      <p>
    To complete the <a data-cite="VC-DATA-MODEL-2.0#dfn-verify">verification</a> process,
    a <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifier</a> needs to obtain the cryptographic keys used to secure the
    <a data-cite="VC-DATA-MODEL-2.0#dfn-credential">credential</a>.
      </p>
      <p>
    There are several different ways to discover the verification keys of
    the <a data-cite="VC-DATA-MODEL-2.0#dfn-issuers">issuers</a>
    and <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">holders</a>.
      </p>


    <section>
      <h2>Using Header Parameters and Claims for Key Discovery</h2>
      <p>
      These JOSE header parameters and JWT claims can be used by
      <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifiers</a> to discover verification keys.
      </p>
      <section>
        <h2>kid</h2>
        <p>
      If <code>kid</code> is present in the <a data-cite="RFC7515#section-4.1">JOSE Header</a>,
      a <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifier</a> can use this parameter
      as a hint indicating which key was used to secure the verifiable credential, when performing a
      <a data-cite="VC-DATA-MODEL-2.0#dfn-verify">verification</a> process as defined in <a data-cite="RFC7515#section-4.1.4">RFC7515</a>.
        </p>
        <p>
          <code>kid</code> MUST be present when the key of the <a data-cite="VC-DATA-MODEL-2.0#dfn-issuers">issuer</a>
          or <a data-cite="VC-DATA-MODEL-2.0#dfn-subjects">subject</a> is expressed as a DID URL.
        </p>
      </section>
      <section>
        <h2>iss</h2>
        <p>
      If <code>iss</code> is present in the <a data-cite="RFC7515#section-4.1">JOSE Header</a>
      or the <a data-cite="RFC7519#section-4.1.1">JWT Claims </a>,
      a <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifier</a> can use this parameter
      to obtain a <a data-cite="RFC7517#section-4">JSON Web Key</a> to use in the
      <a data-cite="VC-DATA-MODEL-2.0#dfn-verify">verification</a> process.
        </p>
        <p>
      The value of the <a data-cite="VC-DATA-MODEL-2.0#issuer">issuer</a> property can be either a string or an object.
      When <code>issuer</code> value is a string, <code>iss</code> value, if present, MUST match <code>issuer</code> value.
      When <code>issuer</code> value is an object with an <code>id</code> value,
      <code>iss</code> value, if present, MUST match <code>issuer.id</code> value.
        </p>
        <p>
      If <code>kid</code> is also present in the
      <a data-cite="RFC7515#section-4.1">JOSE Header</a>, it is used to
      distinguish the specific key used.
        </p>
      </section>

      <section>
        <h2>cnf</h2>
        <p>
      If <code>cnf</code> is present in the <a data-cite="RFC7515#section-4.1">JOSE Header</a>
      or the <a data-cite="RFC7519#section-4.1.1">JWT Claims </a>,
      a <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifier</a> MAY use this parameter
      to identify a proof-of-possession key in the manner described in [[RFC7800]] for use in the
      <a data-cite="VC-DATA-MODEL-2.0#dfn-verify">verification</a> process.
        </p>
      </section>
      </section>

      <section>
      <h2>Well Known URIs</h2>
      <p class="issue" data-number="160">
      The working group is currently exploring how
      <a data-cite="RFC5785#section-3">Defining Well-Known Uniform Resource Identifiers (URIs)</a>
      could be leveraged to assist a <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifier</a> in discovering verification keys for
      <a data-cite="VC-DATA-MODEL-2.0#dfn-issuers">issuers</a>
      and <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">holders</a>.
      </p>

      <section>
        <h2>JWT Issuer</h2>
            <p>
              When the issuer value is a URL using the HTTPS scheme,
              issuer metadata including the issuer's public keys can be retrieved using the mechanism
              defined in [[SD-JWT-VC]].
            </p>
          </section>
        </section>
        <section>
        <h3>Controller Documents</h3>
          <p>
A <a>controller document</a> is a set of data that specifies one or more
relationships between a <a>controller</a> and a set of data, such as a set of
public cryptographic keys. The <a>controller document</a> SHOULD
contain <a>verification relationships</a> that explicitly permit the use of
certain <a>verification methods</a> for specific purposes.
          </p>


        <section>
          <h2>Verification Methods</h2>
            <p>
A <a>controller document</a> can express <a>verification methods</a>, such as
cryptographic <a>public keys</a>, which can be used to <a>authenticate</a> or
authorize interactions with the <a>controller</a> or associated parties. For
example, a cryptographic <a>public key</a> can be used as a <a>verification
method</a> with respect to a digital signature; in such usage, it verifies that
the signer could use the associated cryptographic private key. <a>Verification
methods</a> might take many parameters. An example of this is a set of five
cryptographic keys from which any three are required to contribute to a
cryptographic threshold signature.
            </p>

          <dl>
            <dt><dfn class="lint-ignore">verificationMethod</dfn></dt>
            <dd>
              <p>
The `verificationMethod` property is OPTIONAL. If present, its value
MUST be a <a data-cite="INFRA#ordered-set">set</a> of <a>verification
methods</a>, where each <a>verification method</a> is expressed using a <a
data-cite="INFRA#ordered-map">map</a>. The <a>verification method</a> <a
data-cite="INFRA#ordered-map">map</a> MUST include the `id`,
`type`, `controller`, and specific verification material
properties that are determined by the value of `type` and are defined
in <a href="#verification-material"></a>. A <a>verification method</a> MAY
include additional properties.
              </p>

              <dl>
                <dt>id</dt>
                <dd>
                  <p>
The value of the `id` property for a <a>verification
method</a> MUST be a <a data-cite="INFRA#string">string</a> that
conforms to the [[URL]] syntax.
                  </p>
                </dd>
                <dt>type</dt>
                <dd>
The value of the `type` property MUST be a <a
data-cite="INFRA#string">string</a> that references exactly one <a>verification
method</a> type. To maximize interoperability, the
<a>verification method</a> type SHOULD be `JsonWebKey`.
                </dd>
                <dt><span id="defn-controller">controller</span></dt>
                <dd>
The value of the `controller` property MUST be a <a
data-cite="INFRA#string">string</a> that conforms to the [[URL]] syntax.
                </dd>
                <dt><dfn class="lint-ignore">revoked</dfn></dt>
                <dd>
The `revoked` property is OPTIONAL. If present, its value MUST be an [[XMLSCHEMA11-2]]
combined date and time string specifying when the <a>verification method</a>
SHOULD cease to be used. Once the value is set, it is not expected to be updated, and
systems depending on the value are expected to not verify any proofs associated
with the <a>verification method</a> at or after the time of revocation.
                </dd>
              </dl>
            </dd>
          </dl>

          <pre class="example nohighlight"
            title="Example verification method structure">
    {
      "@context": [
        "https://www.w3.org/ns/did/v1",
        "https://www.w3.org/ns/credentials/v2",
        "https://w3id.org/security/jwk/v1"
      ]
      "id": "did:example:123456789abcdefghi",
      <span class="comment">...</span>
      "verificationMethod": [{
        "id": <span class="comment">...</span>,
        "type": <span class="comment">...</span>,
        "controller": <span class="comment">...</span>,
        "publicKeyJwk": <span class="comment">...</span>
      }]
    }
          </pre>

          <p class="note"
            title="Verification method controller(s) and controller(s)">
The semantics of the `controller` property are the same when the
subject of the relationship is the <a>controller document</a> as when the subject of
the relationship is a <a>verification method</a>, such as a cryptographic public
key. Since a key can't control itself, and the key controller cannot be inferred
from the <a>controller document</a>, it is necessary to explicitly express the identity
of the controller of the key. The difference is that the value of
`controller` for a <a>verification method</a> is <em>not</em>
necessarily a <a>controller</a>. <a>Controllers</a> are expressed
using the `<a>controller</a>` property at the highest level of the
<a>controller document</a>.
          </p>

          <section>
            <h3>Verification Material</h3>

            <p>
Verification material MUST be expressed in the <code>publicKeyJwk</code> property
of a <code>JsonWebKey</code> or as a <code>COSE_Key</code>. This key material is retrieved based on hints in the
JOSE or COSE message envelopes, such as <code>kid</code> or <code>iss</code>. At
the time of writing, there is no standard way to retrieve a public key in JWK or
COSE_Key from a DID URL or controller document.
            </p>


            <p>
A <a>verification method</a> MUST NOT contain multiple verification material
properties for the same material. For example, expressing key material in a
<a>verification method</a> using both `publicKeyJwk` and
another representtion is prohibited.
            </p>

            <p>
Implementations MAY convert keys between formats as desired for operational purposes or
to interface with cryptographic libraries. As an internal implementation detail, such
conversion MUST NOT affect the external representation of key material.
            </p>

            <p>
An example of a <a>controller document</a> containing <a>verification
methods</a> using both properties above is shown below.
            </p>

        <pre id="example-various-verification-method-types"
              class="example nohighlight"
              title="Verification method using publicKeyJwk">
    {
      "@context": [
        "https://www.w3.org/ns/did/v1",
        "https://www.w3.org/ns/credentials/v2",
        "https://w3id.org/security/jwk/v1"
      ]
      "id": "did:example:123456789abcdefghi",
      <span class="comment">...</span>
      "verificationMethod": [
        {
          "id": "did:example:123#_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A",
          "type": "JsonWebKey", <span class="comment">// external (property value)</span>
          "controller": "did:example:123",
          "publicKeyJwk": {
            "crv": "Ed25519", <span class="comment">// external (property name)</span>
            "x": "VCpo2LMLhn6iWku8MKvSLg2ZAoC-nlOyPVQaO3FxVeQ", <span class="comment">// external (property name)</span>
            "kty": "OKP", <span class="comment">// external (property name)</span>
            "kid": "_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A" <span class="comment">// external (property name)</span>
          }
        }
      ],
      <span class="comment">...</span>
    }
            </pre>
          </section>


          <section>
            <h3>JsonWebKey</h3>
            <p>
The JSON Web Key (JWK) is a specific type of <a>verification method</a>
that uses the JWK specification [[RFC7517]] to encode key types into a
set of parameters.
            </p>

            <p>
When specifying a `JsonWebKey`, the object takes the following form:
            </p>

            <dl>
              <dt>type</dt>
              <dd>
The value of the `type` property MUST contain the string `JsonWebKey`.
              </dd>
              <dt><dfn class="lint-ignore">publicKeyJwk</dfn></dt>
              <dd>
                <p>
The `publicKeyJwk` property is REQUIRED, and its value MUST
be a JSON Web Key that conforms to [[RFC7517]].
It is RECOMMENDED that verification methods that use
JWKs [[RFC7517]] to represent their <a>public keys</a> use the value of `kid` as
their fragment identifier. It is RECOMMENDED that JWK `kid` values be set to
the public key fingerprint [[RFC7638]]. See the first key in the example below
for an instance of a public key with a compound key identifier.
                </p>
                <p>
As specified in <a data-cite="RFC7517#section-4.4">Section 4.4 of the JWK specification</a>,
the OPTIONAL `alg` property identifies the algorithm intended for use with the public key,
and SHOULD be included to prevent security issues that can arise when using the same
key with multiple algorithms. As specified in <a data-cite="RFC7518#section-6.2.1.1">
Section 6.2.1.1 of the JWA specification</a>, describing a key using an elliptic curve,
the REQUIRED `crv` property is used to identify the particular curve type of the public key.
As specified in <a data-cite="RFC7515#section-4.1.4">Section 4.1.4 of the JWS specification</a>,
the OPTIONAL `kid` property is a hint used to help discover the key; if present, the `kid` value SHOULD
match, or be included in, the `id` property of the encapsulating `JsonWebKey` object,
as part of the path, query, or fragment of the URL.
                </p>
              </dd>
              <dt><dfn class="lint-ignore">secretKeyJwk</dfn></dt>
              <dd>
The `secretKeyJwk` property is OPTIONAL. If present, its value MUST be a <a
data-cite="INFRA#ordered-map">map</a> representing a JSON Web Key that conforms
to [[RFC7517]].
It MUST NOT be used if the data structure containing it is public or may be revealed to parties other than the legitimate holders of the secret key.
              </dd>
            </dl>

            <p>
An example of an object that conforms to `JsonWebKey` is provided below:
            </p>

            <pre class="example nohighlight" title="JSON Web Key encoding of a secp384r1 (P-384) public key">
{
  "id": "did:example:123456789abcdefghi#key-1",
  "type": "JsonWebKey",
  "controller": "did:example:123456789abcdefghi",
  "publicKeyJwk": {
      "kid": "key-1",
      "kty": "EC",
      "crv": "P-384",
      "alg": "ES384",
      "x": "1F14JSzKbwxO-Heqew5HzEt-0NZXAjCu8w-RiuV8_9tMiXrSZdjsWqi4y86OFb5d",
      "y": "dnd8yoq-NOJcBuEYgdVVMmSxonXg-DU90d7C4uPWb_Lkd4WIQQEH0DyeC2KUDMIU"
    }
}
            </pre>

            <p>
In the example above, the `publicKeyJwk` value contains the JSON Web Key.
The `kty` property encodes the key type of "OKP", which means
"Octet string key pairs". The `alg` property identifies the algorithm intended
for use with the public key, which in this case is `ES384`. The `crv` property identifies
the particular curve type of the public key, `P-384`. The `x` property specifies
the point on the P-384 curve that is associated with the public key.
            </p>

            <p>
The `publicKeyJwk` property MUST NOT contain any property marked as
"Private" or "Secret" in any registry contained in the JOSE Registries [[JOSE-REGISTRIES]], including "d".
            </p>

            <p>
JSON Web Key is also capable of encoding <em>secret keys</em>, sometimes
referred to as <em>private keys</em>.
            </p>

            <pre class="example nohighlight"
              title="JSON Web Key encoding of a secp384r1 (P-384) secret key">
{
  "id": "did:example:123456789abcdefghi#key-1",
  "type": "JsonWebKey",
  "controller": "did:example:123456789abcdefghi",
  "secretKeyJwk": {
      "kty": "EC",
      "crv": "P-384",
      "alg": "ES384",
      "d": "fGwges0SX1mj4eZamUCL4qtZijy9uT15fI4gKTuRvre4Kkoju2SHM4rlFOeKVraH",
      "x": "1F14JSzKbwxO-Heqew5HzEt-0NZXAjCu8w-RiuV8_9tMiXrSZdjsWqi4y86OFb5d",
      "y": "dnd8yoq-NOJcBuEYgdVVMmSxonXg-DU90d7C4uPWb_Lkd4WIQQEH0DyeC2KUDMIU"
    }
}
            </pre>

            <p>
The private key example above is almost identical to the previous example of the
public key, except that the information is stored in the `secretKeyJwk` property
(rather than the `publicKeyJwk`), and the private key value is encoded in the `d`
property thereof (alongside the `x` property, which still specifies the point on
the secp384r1 curve that is associated with the public key).
            </p>

          </section>

          <section>
            <h3>Referring to Verification Methods</h3>
            <p>
<a>Verification methods</a> can be referenced from properties
associated with various <a>verification relationships</a> as described in <a
href="#verification-relationships"></a>. Referencing <a>verification methods</a>
allows them to be used by more than one <a>verification relationship</a>.
            </p>

            <p>
If the value of a <a>verification method</a> property is a
URL <a data-cite="INFRA#string">string</a>, the <a>verification method</a> has
been included by reference and its properties will need to be retrieved from
elsewhere in the <a>controller document</a> or from another <a>controller document</a>. This
is done by dereferencing the URL and searching the resulting <a>resource</a> for a
<a>verification method</a> <a data-cite="INFRA#ordered-map">map</a> with an
`id` property whose value matches the URL.
            </p>

            <pre class="example nohighlight"
            title="Referencing verification methods">
    {
<span class="comment">...</span>

      "authentication": [
        <span class="comment">// this key is referenced and might be used by</span>
        <span class="comment">// more than one verification relationship</span>
        "did:example:123456789abcdefghi#keys-1",
      ],

<span class="comment">...</span>
    }
            </pre>
          </section>
        </section>

        <section>
          <h2>Verification Relationships</h2>

          <p>
A <a>verification relationship</a> expresses the relationship between the
<a>controller</a> and a <a>verification method</a>.
          </p>
          <p>
Different <a>verification relationships</a> enable the associated
<a>verification methods</a> to be used for different purposes. It is up to a
<em>verifier</em> to ascertain the validity of a verification attempt by
checking that the <a>verification method</a> used is contained in the
appropriate <a>verification relationship</a> property of the
<a>controller document</a>.
          </p>
          <p>
The <a>verification relationship</a> between the <a>controller</a> and the
<a>verification method</a> is explicit in the <a>controller document</a>.
<a>Verification methods</a> that are not associated with a particular
<a>verification relationship</a> cannot be used for that <a>verification
relationship</a>.
          </p>
          <p>
The <a>controller document</a> does not express revoked keys using a <a>verification
relationship</a>. If a referenced verification method is not in the latest
<a>controller document</a> used to dereference it, then that verification method is
considered invalid or revoked.
          </p>
          <p>
The following sections define several useful <a>verification relationships</a>.
A <a>controller document</a> MAY include any of these, or other properties, to
express a specific <a>verification relationship</a>. To maximize global
interoperability, any such properties used SHOULD be registered in the
<a href="https://w3c.github.io/vc-specs-dir/#proof">VC Specifications Directory</a>.
          </p>
          <section>
            <h2>Authentication</h2>

            <p>
The `authentication` <a>verification relationship</a> is used to
specify how the <a>controller</a> is expected to be <a>authenticated</a>, for
purposes such as logging into a website or engaging in any sort of
challenge-response protocol.
            </p>

            <dl>
              <dt id="defn-authentication">authentication</dt>
              <dd>
The `authentication` property is OPTIONAL. If present, its
value MUST be a <a data-cite="INFRA#ordered-set">set</a> of one or more
<a>verification methods</a>. Each <a>verification method</a> MAY be embedded or
referenced.
              </dd>
            </dl>

            <pre class="example nohighlight" title="Authentication property
                          containing three verification methods">
    {
      "@context": [
        "https://www.w3.org/ns/did/v1",
        "https://www.w3.org/ns/credentials/v2"
      ],
      "id": "did:example:123456789abcdefghi",
      <span class="comment">...</span>
      "authentication": [
        <span class="comment">// this method can be used to authenticate as did:...fghi</span>
        "did:example:123456789abcdefghi#keys-1",
      <span class="comment">...</span>
    }
            </pre>

            <p>
If authentication is established, it is up to the application to decide what to
do with that information.
            </p>
            <p>
This is useful to any <em>authentication verifier</em> that needs to check to
see whether an entity that is attempting to <a>authenticate</a> is, in fact,
presenting a valid proof of authentication. When a <em>verifier</em> receives
some data (in some protocol-specific format) that contains a proof that was made
for the purpose of "authentication", and that says that an entity is identified
by the `id`, then that <em>verifier</em> checks to ensure that the proof can be
verified using a <a>verification method</a> (e.g., <a>public key</a>) listed
under `<a>authentication</a>` in the <a>controller document</a>.
            </p>
            <p>
Note that the <a>verification method</a> indicated by the
`<a>authentication</a>` property of a <a>controller document</a> can
only be used to <a>authenticate</a> the <a>controller</a>. To
<a>authenticate</a> a different <a>controller</a>, the entity associated with
the value of `controller` needs to <a>authenticate</a> with its
<em>own</em> <a>controller document</a> and associated
`<a>authentication</a>` <a>verification relationship</a>.
            </p>
          </section>

          <section>
            <h2>Assertion</h2>

            <p>
The `assertionMethod` <a>verification relationship</a> is used to
specify how the <a>controller</a> is expected to express claims, such as for
the purposes of issuing a Verifiable Credential [[?VC-DATA-MODEL-2.0]].
            </p>

            <dl>
              <dt>assertionMethod</dt>
              <dd>
The `assertionMethod` property is OPTIONAL. If present, its
value MUST be a <a data-cite="INFRA#ordered-set">set</a> of
one or more <a>verification methods</a>. Each <a>verification method</a> MAY be
embedded or referenced.
              </dd>
            </dl>

            <p>
This property is useful, for example, during the processing of a <a>verifiable
credential</a> by a verifier.
            </p>

            <pre class="example nohighlight" title="Assertion method property">
    {
      "@context": [
        "https://www.w3.org/ns/did/v1",
        "https://www.w3.org/ns/credentials/v2"
      ],
      "id": "did:example:123456789abcdefghi",
      <span class="comment">...</span>
      "assertionMethod": [
        <span class="comment">// this method can be used to assert statements as did:...fghi</span>
        "did:example:123456789abcdefghi#keys-1",
      <span class="comment">...</span>
    }
            </pre>
          </section>
        </section>
      </section>
      </section>

  <section id="conformance">
    <section class="normative">
      <h2>Securing Verifiable Credentials</h2>
      <p>The <a data-cite="VC-DATA-MODEL-2.0#proof-formats"></a> describes the approach taken by JSON Web
        Tokens to secure JWT Claims Sets as <i>applying an
        <code>external proof</code></i>.
      </p>
      <p>The normative statements in <a data-cite="VC-DATA-MODEL-2.0#securing-verifiable-credentials">Securing
          Verifiable Credentials</a> apply to securing
        <code>application/vc+ld+json</code> and
        <code>application/vp+ld+json</code>
        as <code>application/vc+ld+json+sd-jwt</code> and
        <code>application/vp+ld+json+sd-jwt</code>.
      </p>
      <p>
        JSON Web Token implementers are advised to review <a data-cite="RFC7519#section-8">Implementation
          Requirements</a>.
      </p>
      <p>
        Accordingly, Issuers, Holders, and Verifiers MUST understand the
        JSON Web Token header parameter
        <code>"alg": "none"</code> when securing [[VC-DATA-MODEL-2.0]]
        with JSON Web Tokens.
        When content types from [[VC-DATA-MODEL-2.0]] are secured using
        JSON Web Tokens, the header parameter <code>"alg": "none"</code>,
  MUST be used to communicate that a JWT Claims Set (a
        Verifiable Credential or a Verifiable Presentation) has no
        integrity protection.
        When a JWT Claims Set (a Verifiable Credential or a
        Verifiable Presentation) contains
        <code>proof</code>, and the JSON Web Token header contains
        <code>"alg": "none"</code>, the JWT Claims Set MUST be considered to
        have no integrity protection.
      </p>
      <p class="advisement">
        Verifiable Credentials and Verifiable Presentations are not
        required to be secured or integrity protected or to contain a
        <code>proof</code> member.
      </p>
      <p>
        Issuers, Holders, and Verifiers MUST ignore all JWT Claims Sets that
        have no integrity protection.
      </p>
      <p>
        The JWT Claim Names <code>vc</code> and <code>vp</code>
        MUST NOT be present in any JWT Claims Set.
      </p>
    </section>

  </section>

  <section class="informative">
    <h2>Wallets</h2>
    <p>
    <a data-cite="VC-DATA-MODEL-2.0#dfn-issuers">Issuers</a>,
    <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">Holders</a> and
    <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">Verifiers</a> might rely on clients,
    as defined in [[RFC4949]].
    Such clients are often referred to as <i>wallets</i> or <i>digital credential wallets</i>,
    when they support storing and presenting digital credentials.
    </p>
    <p>
    To meet <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">Verifier</a> requirements, some
    <a data-cite="VC-DATA-MODEL-2.0#dfn-issuers">Issuers</a> might need to assess the quality of a wallet used by a
    <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">Holder</a>, prior to issuing and
    delivering credentials to a <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">Holder</a>.
    </p>
    <p>
    For example, some <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">Verifiers</a> might require that cryptographic material
    associated with a <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">Holder</a>, be protected at specific
    assurance levels.
    (See <a href="https://pages.nist.gov/800-63-3-Implementation-Resources/63B/AAL/">NIST 800-63-3: Authenticator Assurance Levels</a>.)
    </p>
    <p class="note">
      Also see <a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-attestation-based-client-auth">
        OAuth 2.0 Attestation-Based Client Authentication
      </a>.
    </p>
  </section>

  <section class="normative">
    <h2>IANA Considerations</h2>

    <section>
    <h2>Media Types</h2>
    <section id="vc-ld-sd-jwt-media-type">
      <h2><code>application/vc+ld+json+sd-jwt</code></h2>
      <p>
        This specification registers the
        <code>application/vc+ld+json+sd-jwt</code> Media Type specifically for
        identifying a <a data-cite="SD-JWT"></a>
        conforming to the Verifiable Credential Data Model.
      </p>
      <table>
        <tr>
          <td>Type name: </td>
          <td>`application`</td>
        </tr>
        <tr>
          <td>Subtype name: </td>
          <td>`vc+ld+json+sd-jwt`</td>
        </tr>
        <tr>
          <td>Required parameters: </td>
          <td>None</td>
        </tr>
        <tr>
          <td>Encoding considerations: </td>
          <td>
            binary; `application/sd-jwt` values are a series of base64url-encoded values
            (some of which may be the empty string) separated by period ('.') or tilde ('~') characters.
          </td>
        </tr>
        <tr>
          <td>Security considerations: </td>
          <td>
            <p>As defined in this specification. See also the security
            considerations in <a data-cite="SD-JWT"></a>.</p>
          </td>
        </tr>
        <tr>
          <td>Contact: </td>
          <td>
            W3C Verifiable Credentials Working Group <a
            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
          </td>
        </tr>
      </table>
    </section>
    <section id="vp-ld-sd-jwt-media-type">
      <h2><code>application/vp+ld+json+sd-jwt</code></h2>
      <p>
        This specification registers the
        <code>application/vp+ld+json+sd-jwt</code> Media Type specifically for
        identifying a <a data-cite="SD-JWT"></a>
        conforming to the Verifiable Presentations.
      </p>
      <table>
        <tr>
          <td>Type name: </td>
          <td>application</td>
        </tr>
        <tr>
          <td>Subtype name: </td>
          <td>vp+ld+json+sd-jwt</td>
        </tr>
        <tr>
          <td>Required parameters: </td>
          <td>None</td>
        </tr>
        <tr>
          <td>Encoding considerations: </td>
          <td>
            binary; `application/sd-jwt` values are a series of base64url-encoded values
            (some of which may be the empty string) separated by period ('.') or tilde ('~') characters.
          </td>
        </tr>
        <tr>
          <td>Security considerations: </td>
          <td>
            <p>As defined in this specification. See also the security
            considerations in <a data-cite="SD-JWT"></a>.</p>
          </td>
        </tr>
        <tr>
          <td>Contact: </td>
          <td>
            W3C Verifiable Credentials Working Group <a
            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
          </td>
        </tr>
      </table>
    </section>

    <section id="vc-ld-json-cose-media-type">
      <h2><code>application/vc+ld+json+cose</code></h2>
      <p>
        This specification registers the
        <code>application/vc+ld+json+cose</code> Media Type specifically for
        identifying a cose-sign1, as described in <a data-cite="COSE-Sign-1"></a>
        conforming to the Verifiable Credential Data Model.
      </p>
      <p class="advisement">
        Remove this note before publishing, see this similar example:
        <a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-constrained-voucher#section-16.2.1">
          application/voucher+cose
        </a>
      </p>
      <table>
        <tr>
          <td>Type name: </td>
          <td>`application`</td>
        </tr>
        <tr>
          <td>Subtype name: </td>
          <td>`vc+ld+json+cose`</td>
        </tr>
        <tr>
          <td>Required parameters: </td>
          <td>None</td>
        </tr>
        <tr>
          <td>Encoding considerations: </td>
          <td>
            binary (CBOR)
          </td>
        </tr>
        <tr>
          <td>Security considerations: </td>
          <td>
            <p>As defined in this specification. See also the security
            considerations in <a data-cite="COSE-Sign-1"></a>.</p>
          </td>
        </tr>
        <tr>
          <td>Contact: </td>
          <td>
            W3C Verifiable Credentials Working Group <a
            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
          </td>
        </tr>
      </table>
    </section>
    <section id="vp-ld-json-cose-media-type">
      <h2><code>application/vp+ld+json+cose</code></h2>
      <p>
        This specification registers the
        <code>application/vp+ld+json+cose</code> Media Type specifically for
        identifying a cose-sign1, as described in <a data-cite="COSE-Sign-1"></a>
        conforming to the Verifiable Credential Data Model.
      </p>
      <p class="advisement">
        Remove this note before publishing, see this similar example:
        <a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-constrained-voucher#section-16.2.1">
          application/voucher+cose
        </a>
      </p>
      <table>
        <tr>
          <td>Type name: </td>
          <td>`application`</td>
        </tr>
        <tr>
          <td>Subtype name: </td>
          <td>`vp+ld+json+cose`</td>
        </tr>
        <tr>
          <td>Required parameters: </td>
          <td>None</td>
        </tr>
        <tr>
          <td>Encoding considerations: </td>
          <td>
            binary (CBOR)
          </td>
        </tr>
        <tr>
          <td>Security considerations: </td>
          <td>
            <p>As defined in this specification. See also the security
            considerations in <a data-cite="COSE-Sign-1"></a>.</p>
          </td>
        </tr>
        <tr>
          <td>Contact: </td>
          <td>
            W3C Verifiable Credentials Working Group <a
            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
          </td>
        </tr>
      </table>
    </section>
  </section>

</section>
  <section>
    <h3>Other Considerations</h3>

    <section>
      <h2>Privacy Considerations</h2>
      <p>
        Verifiable Credentials often contain sensitive information that
        needs to be protected to ensure the privacy and security of
        organizations and individuals. This section outlines some
        privacy considerations relevant to implementers and users.
      </p>
      <p>
        Implementers are advised to note and abide by all privacy
        considerations called out in [[VC-DATA-MODEL-2.0]].
      </p>
      <p>
        Implementers are additionally advised to reference the
        <a href="https://www.rfc-editor.org/rfc/rfc7519#section-12">Privacy
          Consideration</a>
        section of the JWT specification for privacy guidance.
      </p>
      <p>
        In addition to the privacy recommendations in the
        [[VC-DATA-MODEL-2.0]], the following considerations are given:
      <ul>
        <li>
          <p>
            Minimization of data: It is considered best practice for
            Verifiable Credentials to only contain the minimum amount of
            data necessary to achieve their intended purpose. This helps
            to limit the amount of sensitive information that is shared
            or stored unnecessarily.
          </p>
        </li>
        <li>
          <p>
            Informed consent: It is considered best practice that
            individuals be fully informed about how their data will be
            used and provide the ability to consent to or decline the
            use of their data. This helps to ensure that individuals
            maintain control over their own personal information.
          </p>
        </li>
        <li>
          <p>
            Data protection: It is considered best practice to protect
            Verifiable Credentials using strong encryption and other
            security measures to prevent unauthorized access,
            modification, or disclosure.
          </p>
        </li>
      </ul>
      </p>
      <p>
        These considerations are not exhaustive, and implementers and
        users are advised to consult additional privacy resources and
        best practices to ensure the privacy and security of Verifiable
        Credentials implemented using this specification.
      </p>
    </section>
    <section>
      <h2>Security Considerations</h2>
      <p>
        This section outlines security considerations for implementers
        and users of this specification. It is important to carefully
        consider these factors to ensure the security and integrity of
        Verifiable Credentials when implemented using JOSE or COSE.
      </p>
      <p>
        When implementing this specification, it is essential to address all
        security issues relevant to broad cryptographic applications.
        This especially includes protecting the user's asymmetric
        private and symmetric secret keys, as well as employing
        countermeasures against various attacks. Failure to adequately
        address these issues could compromise the security and integrity
        of Verifiable Credentials, potentially leading to unauthorized
        access, modification, or disclosure of sensitive information.
      </p>
      <p>
        Implementers are advised to follow best practices and
        established cryptographic standards to ensure the secure
        handling of keys and other sensitive data. Additionally, conduct
        regular security assessments and audits to identify and address
        any vulnerabilities or threats.
      </p>
      <p>
        Follow all security considerations outlined in [[RFC7515]] and
        [[RFC7519]].
      </p>
      <p>
        When utilizing JSON-LD, take special care around remote
        retrieval of contexts and follow the additional security
        considerations noted in [[json-ld11]].
      </p>
      <p>
        As noted in [[RFC7515]] when utilizing JSON [[RFC7159]], strict
        validation is a security requirement. If malformed JSON is
        received, it may be impossible to reliably interpret the
        producer's intent, potentially leading to ambiguous or
        exploitable situations. To prevent these risks, it is essential
        to use a JSON parser that strictly validates the syntax of all
        input data. It is essential that any JSON inputs that do not
        conform to the JSON-text syntax defined in [[RFC7159]] be
        rejected in their entirety by JSON parsers. Failure to reject
        invalid input could compromise the security and integrity of
        Verifiable Credentials.
      </p>
    </section>
    <section class="informative">
      <h2>Accessibility</h2>
      <p>
        When implementing this specification, it is crucial for
        technical implementers to consider various accessibility
        factors. Ignoring accessibility concerns renders the information
        unusable for a significant portion of the population. To ensure
        equal access for all individuals, regardless of their abilities,
        it is vital to adhere to accessibility guidelines and standards,
        such as the Web Content Accessibility Guidelines (WCAG 2.1)
        [[WCAG21]]. This becomes even more critical when establishing
        systems that involve cryptography, as they have historically
        posed challenges for assistive technologies.
      </p>
      <p>
        Implementers are advised to note and abide by all accessibility
        considerations called out in [[VC-DATA-MODEL-2.0]].
      </p>
    </section>
  </section>


  <section class="informative">
    <h3>Appendix</h3>
    <section>
      <h2>Controllers</h2>

      <pre class="example" title="A minimal controller document">
        {
          "id": "https://vendor.example",
        }
      </pre>

      <pre class="example" title="A controller document with verification method">
        {
          "id": "https://university.example/issuers/565049",
          "verificationMethod": [{
            "id": "https://university.example/issuers/565049#key-123",
            "type": "JsonWebKey",
            "controller": "https://university.example/issuers/565049",
            "publicKeyJwk": {
              "kty": "EC",
              "crv": "P-384",
              "alg": "ES384",
              "x": "PxgAmVYOQvSNcMYL2tOzoLwSWn4Ta3tIMPEUKR8pxeb-gmR11-DyKHBoIiY-2LhM",
              "y": "BZEBTkImVdpwvxR9THIRw16eblnj5-tZa7m-ww5uVd4kyPJNRoWUn2aT9ZuarAe-"
            }
          }]
        }
      </pre>

      <pre class="example" title="A controller document with verification relationships">
        {
          "id": "https://university.example/issuers/565049",
          "verificationMethod": [{
            "id": "https://university.example/issuers/565049#key-123",
            "type": "JsonWebKey",
            "controller": "https://university.example/issuers/565049",
            "publicKeyJwk": {
              "kty": "EC",
              "crv": "P-384",
              "alg": "ES384",
              "x": "PxgAmVYOQvSNcMYL2tOzoLwSWn4Ta3tIMPEUKR8pxeb-gmR11-DyKHBoIiY-2LhM",
              "y": "BZEBTkImVdpwvxR9THIRw16eblnj5-tZa7m-ww5uVd4kyPJNRoWUn2aT9ZuarAe-"
            }
          }],
          "authentication": ["https://university.example/issuers/565049#key-123"],
          "assertionMethod": ["https://university.example/issuers/565049#key-123"]
        }
      </pre>

      <pre class="example" title="A verifiable credential controller document">
{
  "@context": [
        "https://www.w3.org/ns/did/v1",
        "https://w3id.org/security/jwk/v1",
        {
            "@vocab": "https://vendor.example#"
        }
  ],
  "id": "did:web:vendor.example",
  "alsoKnownAs": ["https://vendor.example",
    "did:jwk:eyJraWQiOiJ1cm46aWV0ZjpwYXJhbXM6b2F1dGg6andrLXRodW1icHJpbnQ6c2hhLTI1NjpGZk1iek9qTW1RNGVmVDZrdndUSUpqZWxUcWpsMHhqRUlXUTJxb2JzUk1NIiwia3R5IjoiT0tQIiwiY3J2IjoiRWQyNTUxOSIsImFsZyI6IkVkRFNBIiwieCI6IkFOUmpIX3p4Y0tCeHNqUlBVdHpSYnA3RlNWTEtKWFE5QVBYOU1QMWo3azQifQ"
  ],
  "verificationMethod": [{
    "id": "#urn:ietf:params:oauth:jwk-thumbprint:sha-256:NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs",
    "type": "JsonWebKey",
    "controller": "did:web:vendor.example",
    "publicKeyJwk": {
      "kty": "EC",
      "crv": "P-521",
      "alg": "ES512",
      "x": "AFTyMw-fIYJNg6fBVJvOPOsLxmnNj8HgqMChyRL0swLaefVAc7wrWZ8okQJqMmvv03JRUp277meQZM3JcvXFkH1v",
      "y": "ALn96CrD88b4TClmkl1sk0xk2FgAIda97ZF8TUOjbeWSzbKnN2KB6pqlpbuJ2xIRXvsn5BWQVlAT2JGpGwDNMyV1"
    }
  }, {
    "id": "#z6MkhEdpG12jyQegrr62ACRmNY8gc531W2j9Xo39cHphuCEH",
    "type": "JsonWebKey2020",
    "controller": "https://vendor.example",
    "publicKeyJwk": {
      "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:FfMbzOjMmQ4efT6kvwTIJjelTqjl0xjEIWQ2qobsRMM",
      "kty": "OKP",
      "crv": "Ed25519",
      "alg": "EdDSA",
      "x": "ANRjH_zxcKBxsjRPUtzRbp7FSVLKJXQ9APX9MP1j7k4"
    }
  }, {
    "id": "#subject-authenticaton",
    "type": "JsonWebKey",
    "controller": "did:web:vendor.example",
    "publicKeyJwk": {
      "kty": "EC",
      "crv": "P-384",
      "alg": "ES384",
      "x": "PxgAmVYOQvSNcMYL2tOzoLwSWn4Ta3tIMPEUKR8pxeb-gmR11-DyKHBoIiY-2LhM",
      "y": "BZEBTkImVdpwvxR9THIRw16eblnj5-tZa7m-ww5uVd4kyPJNRoWUn2aT9ZuarAe-"
    }
  }, {
    "id": "#credential-issuance",
    "type": "JsonWebKey",
    "controller": "did:web:vendor.example",
    "publicKeyJwk": {
      "kty": "EC",
      "crv": "P-256",
      "alg": "ES256",
      "x": "MYvnaI87pfrn3FpTqW-yNiFcF1K7fedJiqapm20_q7c",
      "y": "9YEbT6Tyuc7xp9yRvhOUVKK_NIHkn5HpK9ZMgvK5pVw"
    }
  }, {
    "id": "#key-agreement",
    "type": "JsonWebKey",
    "controller": "did:web:vendor.example",
    "publicKeyJwk": {
      "kty": "OKP",
      "crv": "X25519",
      "alg": "ECDH-ES+A128KW",
      "x": "qLZkSTbstvMWPTivmiQglEFWG2Ff7gNDVoVisdZTr1I"
    }
  }],
  "authentication": ["#subject-authenticaton"],
  "assertionMethod": ["#credential-issuance"]
}
      </pre>

    </section>
    <section>
      <h3>Credentials</h3>
      <pre class="example vc-jose-cose" title="A revocable credential with multiple subjects">
{
  "@context": ["https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://contoso.example/credentials/23894672394",
  "type": ["VerifiableCredential", "K9UnitCredential"],
  "issuer": {
    "id": "https://contoso.example"
  },
  "validFrom": "2015-04-16T05:11:32.432Z",
  "credentialStatus": {
    "id": "https://contoso.example/credentials/status/4#273762",
    "type": "StatusList2021Entry",
    "statusPurpose": "revocation",
    "statusListIndex": "273762",
    "statusListCredential": "https://contoso.example/credentials/status/4"
  },
  "credentialSubject": [{
    "id": "did:example:1312387641",
    "type": "Person"
  }, {
    "id": "did:example:63888231",
    "type": "Dog"
  }]
}
      </pre>

      <pre class="example vc-jose-cose" title="A credential with a schema">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://contoso.example/credentials/35327255",
  "type": ["VerifiableCredential", "KYCExample"],
  "issuer": "did:web:contoso.example",
  "validFrom": "2019-05-25T03:10:16.992Z",
  "validUntil": "2027-05-25T03:10:16.992Z",
  "credentialSchema": {
    "id": "https://contoso.example/bafybeigdyr...lqabf3oclgtqy55fbzdi",
    "type": "JsonSchema"
  },
  "credentialSubject": {
    "id": "did:example:1231588",
    "type": "Person"
  }
}
      </pre>
    </section>

    <section>
      <h2>
        Presentations
      </h2>

      <pre class="example vc-jose-cose" title="Presentation">
{
  "@context": ["https://www.w3.org/ns/credentials/v2"],
  "type": ["VerifiablePresentation"],
  "holder": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:_Fpfe27AuGmEljZE9s2lw2UH-qrZLRFNrWbJrWIe4SI",
  "verifiableCredential": [{
      "@context": [
        "https://www.w3.org/ns/credentials/v2"
      ],
      "type": [
        "VerifiableCredential"
      ],
      "issuer": "https://issuer.example/issuers/68",
      "validFrom": "2023-06-07T21:14:14.148Z",
      "credentialSubject": {
        "id": "https://subject.vendor.example"
      }
    },
    "https://vendor.example/credentials/42",
    "did:example:123",
    "urn:uuid:01ec9426-c175-4e39-a006-d30050e28214",
    "urn:ietf:params:oauth:jwk-thumbprint:sha-256:_Fpfe27AuGmEljZE9s2lw2UH-qrZLRFNrWbJrWIe4SI",
    "data:application/vc+ld+json+sd-jwt;eyJhbGciOiJFUzM4NCIsImtpZCI6IlNJM1JITm91aDhvODFOT09OUFFVQUw3RWdaLWtJNl94ajlvUkV2WDF4T3ciLCJ0eXAiOiJ2YytsZCtqc29uK3NkLWp3dCIsImN0eSI6InZjK2xkK2pzb24ifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiaXNzdWVyIjoiaHR0cHM6Ly91bml2ZXJzaXR5LmV4YW1wbGUvaXNzdWVycy81NjUwNDkiLCJ2YWxpZEZyb20iOiIyMDEwLTAxLTAxVDE5OjIzOjI0WiIsImNyZWRlbnRpYWxTY2hlbWEiOnsiX3NkIjpbIkU3dU1sSWFyS29iYXJTdEZGRjctZm5qaV9sQVdnM3BGMkV5dVc4dWFYakUiLCJYelRaSVgyNGdDSWxSQVFHclFoNU5FRm1XWkQtZ3Z3dkIybzB5Y0FwNFZzIl19LCJjcmVkZW50aWFsU3ViamVjdCI6eyJkZWdyZWUiOnsibmFtZSI6IkJhY2hlbG9yIG9mIFNjaWVuY2UgYW5kIEFydHMiLCJfc2QiOlsiT3oxUEZIMG0tWk9TdEhwUVZyeGlmVlpKRzhvNmlQQmNnLVZ2SXQwd2plcyJdfSwiX3NkIjpbIkVZQ1daMTZZMHB5X1VNNzRHU3NVYU9zT19mdDExTlVSaFFUTS1TT1lFTVEiXX0sIl9zZCI6WyJqT055NnZUbGNvVlAzM25oSTdERGN3ekVka3d2R3VVRXlLUjdrWEVLd3VVIiwid21BdHpwc0dRbDJveS1PY2JrSEVZcE8xb3BoX3VYcWVWVTRKekF0aFFibyJdLCJfc2RfYWxnIjoic2hhLTI1NiIsImlzcyI6Imh0dHBzOi8vdW5pdmVyc2l0eS5leGFtcGxlL2lzc3VlcnMvNTY1MDQ5IiwiaWF0IjoxNjk3Mjg5OTk2LCJleHAiOjE3Mjg5MTIzOTYsImNuZiI6eyJqd2siOnsia3R5IjoiRUMiLCJjcnYiOiJQLTM4NCIsImFsZyI6IkVTMzg0IiwieCI6InZFdV84WGxZT0ZFU2hTcVRpZ2JSYWduZ0ZGM1p5U0xrclNHekh3azFBT1loanhlazVhV21HY2UwZU05S0pWOEIiLCJ5IjoiRUpNY2czWXBzUTB3M2RLNHlVa25QczE1Z0lsY2Yyay03dzFKLTNlYlBiOERENmQtUkhBeGUwMDkzSWpfdTRCOSJ9fX0.rYzbxb6j1dwop8_s491iArVVJNm6A6C3b742gOm_qYO3zdkyQU4_VxxOSJ8ECcmWj2r5KyiCNC1ojfO4Yms-zBsjt7PoMYpYWBplsqXpiIvnehmM7D0eOLi40uHXki0X~WyJSWTg1YTZNMmEwX3VDWlFTVGZmTFdRIiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~WyJMeG5GYTBXVm8wRUluVy1QdS1fd1dRIiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyJUQVdrakpCaVpxdC1rVU54X1EweUJBIiwgImlkIiwgImh0dHBzOi8vZXhhbXBsZS5vcmcvZXhhbXBsZXMvZGVncmVlLmpzb24iXQ~WyJTd2xuZFpPZzZEZ1ZERFp5X0RvYVFBIiwgInR5cGUiLCAiSnNvblNjaGVtYSJd~WyJuSnJlU3E1Nzg3RGZMSDJCbU03cXFRIiwgImlkIiwgImRpZDpleGFtcGxlOjEyMyJd~WyIxMjNNd3hNcHRiek02YUk2aW03ME1RIiwgInR5cGUiLCAiQmFjaGVsb3JEZWdyZWUiXQ"
  ]
}
      </pre>

    </section>

    <section>
      <h3>Data URIs</h3>
      <pre class="example" title="A simple URI-encoded Verifiable Credential">
data:application/vc+ld+json+sd-jwt;eyJhbGciOiJFUzM4NCIsImtpZCI6IlNJM1JITm91aDhvODFOT09OUFFVQUw3RWdaLWtJNl94ajlvUkV2WDF4T3ciLCJ0eXAiOiJ2YytsZCtqc29uK3NkLWp3dCIsImN0eSI6InZjK2xkK2pzb24ifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiaXNzdWVyIjoiaHR0cHM6Ly91bml2ZXJzaXR5LmV4YW1wbGUvaXNzdWVycy81NjUwNDkiLCJ2YWxpZEZyb20iOiIyMDEwLTAxLTAxVDE5OjIzOjI0WiIsImNyZWRlbnRpYWxTY2hlbWEiOnsiX3NkIjpbIkU3dU1sSWFyS29iYXJTdEZGRjctZm5qaV9sQVdnM3BGMkV5dVc4dWFYakUiLCJYelRaSVgyNGdDSWxSQVFHclFoNU5FRm1XWkQtZ3Z3dkIybzB5Y0FwNFZzIl19LCJjcmVkZW50aWFsU3ViamVjdCI6eyJkZWdyZWUiOnsibmFtZSI6IkJhY2hlbG9yIG9mIFNjaWVuY2UgYW5kIEFydHMiLCJfc2QiOlsiT3oxUEZIMG0tWk9TdEhwUVZyeGlmVlpKRzhvNmlQQmNnLVZ2SXQwd2plcyJdfSwiX3NkIjpbIkVZQ1daMTZZMHB5X1VNNzRHU3NVYU9zT19mdDExTlVSaFFUTS1TT1lFTVEiXX0sIl9zZCI6WyJqT055NnZUbGNvVlAzM25oSTdERGN3ekVka3d2R3VVRXlLUjdrWEVLd3VVIiwid21BdHpwc0dRbDJveS1PY2JrSEVZcE8xb3BoX3VYcWVWVTRKekF0aFFibyJdLCJfc2RfYWxnIjoic2hhLTI1NiIsImlzcyI6Imh0dHBzOi8vdW5pdmVyc2l0eS5leGFtcGxlL2lzc3VlcnMvNTY1MDQ5IiwiaWF0IjoxNjk3Mjg5OTk2LCJleHAiOjE3Mjg5MTIzOTYsImNuZiI6eyJqd2siOnsia3R5IjoiRUMiLCJjcnYiOiJQLTM4NCIsImFsZyI6IkVTMzg0IiwieCI6InZFdV84WGxZT0ZFU2hTcVRpZ2JSYWduZ0ZGM1p5U0xrclNHekh3azFBT1loanhlazVhV21HY2UwZU05S0pWOEIiLCJ5IjoiRUpNY2czWXBzUTB3M2RLNHlVa25QczE1Z0lsY2Yyay03dzFKLTNlYlBiOERENmQtUkhBeGUwMDkzSWpfdTRCOSJ9fX0.rYzbxb6j1dwop8_s491iArVVJNm6A6C3b742gOm_qYO3zdkyQU4_VxxOSJ8ECcmWj2r5KyiCNC1ojfO4Yms-zBsjt7PoMYpYWBplsqXpiIvnehmM7D0eOLi40uHXki0X~WyJSWTg1YTZNMmEwX3VDWlFTVGZmTFdRIiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~WyJMeG5GYTBXVm8wRUluVy1QdS1fd1dRIiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyJUQVdrakpCaVpxdC1rVU54X1EweUJBIiwgImlkIiwgImh0dHBzOi8vZXhhbXBsZS5vcmcvZXhhbXBsZXMvZGVncmVlLmpzb24iXQ~WyJTd2xuZFpPZzZEZ1ZERFp5X0RvYVFBIiwgInR5cGUiLCAiSnNvblNjaGVtYSJd~WyJuSnJlU3E1Nzg3RGZMSDJCbU03cXFRIiwgImlkIiwgImRpZDpleGFtcGxlOjEyMyJd~WyIxMjNNd3hNcHRiek02YUk2aW03ME1RIiwgInR5cGUiLCAiQmFjaGVsb3JEZWdyZWUiXQ
      </pre>

      <pre class="example" title="A simple URI-encoded Verifiable Presentation">
data:application/vp+ld+json+sd-jwt;eyJhbGciOiJFUzM4NCIsImtpZCI6IlNJM1JITm91aDhvODFOT09OUFFVQUw3RWdaLWtJNl94ajlvUkV2WDF4T3ciLCJ0eXAiOiJ2YytsZCtqc29uK3NkLWp3dCIsImN0eSI6InZjK2xkK2pzb24ifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiaXNzdWVyIjoiaHR0cHM6Ly91bml2ZXJzaXR5LmV4YW1wbGUvaXNzdWVycy81NjUwNDkiLCJ2YWxpZEZyb20iOiIyMDEwLTAxLTAxVDE5OjIzOjI0WiIsImNyZWRlbnRpYWxTY2hlbWEiOnsiX3NkIjpbIkU3dU1sSWFyS29iYXJTdEZGRjctZm5qaV9sQVdnM3BGMkV5dVc4dWFYakUiLCJYelRaSVgyNGdDSWxSQVFHclFoNU5FRm1XWkQtZ3Z3dkIybzB5Y0FwNFZzIl19LCJjcmVkZW50aWFsU3ViamVjdCI6eyJkZWdyZWUiOnsibmFtZSI6IkJhY2hlbG9yIG9mIFNjaWVuY2UgYW5kIEFydHMiLCJfc2QiOlsiT3oxUEZIMG0tWk9TdEhwUVZyeGlmVlpKRzhvNmlQQmNnLVZ2SXQwd2plcyJdfSwiX3NkIjpbIkVZQ1daMTZZMHB5X1VNNzRHU3NVYU9zT19mdDExTlVSaFFUTS1TT1lFTVEiXX0sIl9zZCI6WyJqT055NnZUbGNvVlAzM25oSTdERGN3ekVka3d2R3VVRXlLUjdrWEVLd3VVIiwid21BdHpwc0dRbDJveS1PY2JrSEVZcE8xb3BoX3VYcWVWVTRKekF0aFFibyJdLCJfc2RfYWxnIjoic2hhLTI1NiIsImlzcyI6Imh0dHBzOi8vdW5pdmVyc2l0eS5leGFtcGxlL2lzc3VlcnMvNTY1MDQ5IiwiaWF0IjoxNjk3Mjg5OTk2LCJleHAiOjE3Mjg5MTIzOTYsImNuZiI6eyJqd2siOnsia3R5IjoiRUMiLCJjcnYiOiJQLTM4NCIsImFsZyI6IkVTMzg0IiwieCI6InZFdV84WGxZT0ZFU2hTcVRpZ2JSYWduZ0ZGM1p5U0xrclNHekh3azFBT1loanhlazVhV21HY2UwZU05S0pWOEIiLCJ5IjoiRUpNY2czWXBzUTB3M2RLNHlVa25QczE1Z0lsY2Yyay03dzFKLTNlYlBiOERENmQtUkhBeGUwMDkzSWpfdTRCOSJ9fX0.rYzbxb6j1dwop8_s491iArVVJNm6A6C3b742gOm_qYO3zdkyQU4_VxxOSJ8ECcmWj2r5KyiCNC1ojfO4Yms-zBsjt7PoMYpYWBplsqXpiIvnehmM7D0eOLi40uHXki0X~WyJTd2xuZFpPZzZEZ1ZERFp5X0RvYVFBIiwgInR5cGUiLCAiSnNvblNjaGVtYSJd~WyIxMjNNd3hNcHRiek02YUk2aW03ME1RIiwgInR5cGUiLCAiQmFjaGVsb3JEZWdyZWUiXQ~WyJMeG5GYTBXVm8wRUluVy1QdS1fd1dRIiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyJSWTg1YTZNMmEwX3VDWlFTVGZmTFdRIiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~eyJhbGciOiJFUzM4NCIsInR5cCI6ImtiK2p3dCJ9.eyJub25jZSI6IkVmeTROTFJPX3ZvSkszdDIzcUNfQlEiLCJhdWQiOiJodHRwczovL3ZlcmlmaWVyLmV4YW1wbGUiLCJpYXQiOjE2OTcyODk5OTZ9.6G-1nVcrDKFzR6BdbcFHcbtassEb8NZ7ZavTYz3SJ-e4pXleXs0tNcCkUCwMI70gsuOY0AXzeDPbHjp5GKyLDVuNWgWCt3Wo2VSaCwUkyfLyvhkCsmkF9kvFhMIOhp1i
      </pre>
    </section>

    <section>
      <h2>
        COSE Examples
      </h2>
      <p>
These examples rely on <a data-cite="RFC7049#section-6">CBOR Diagnostic Notation</a>.
Remember that all actual interchange always happens in the binary format.
      </p>

      <pre class="example" title="A COSE Sign 1 Protected Header for a Verifiable Credential">
{                                   / Protected                     /
  1: -35,                           / Algorithm                     /
  3: application/vc+ld+json,        / Content type                  /
  4: h'177f12cb...1933d554',        / Key identifier                /
  15: {                             / CWT Claims                    /
    1: urn:example:123,             / Issuer                        /
    2: urn:example:456,             / Subject                       /
  },
}
        </pre>

        <pre class="example" title="A COSE Sign 1 Protected Header for a Verifiable Presentation">
{                                   / Protected                     /
  1: -35,                           / Algorithm                     /
  3: application/vp+ld+json,        / Content type                  /
  4: h'177f12cb...1933d554',        / Key identifier                /
  15: {                             / CWT Claims                    /
    1: urn:example:123,             / Issuer                        /
    2: urn:example:456,             / Subject                       /
  },
}
          </pre>

        <pre class="example" title="A COSE Sign 1 with an attached payload">
18(                                 / COSE Sign 1                   /
    [
      h'a4013822...3a343536',       / Protected Header              /
      {}                            / Unprotected Header            /
      h'0fbe22a0...3a009118',       / Attached payload              /
      h'09772c7f...5c4e736f'        / Signature                     /
    ]
)
      </pre>

      <pre class="example" title="A COSE Sign 1 with a detached payload">
18(                                 / COSE Sign 1                   /
    [
      h'a4013822...3a343536',       / Protected Header              /
      {}                            / Unprotected Header            /
      nil,                          / Detached payload              /
      h'09772c7f...5c4e736f'        / Signature                     /
    ]
)
      </pre>
      <p>
The payload can be either a credential or presentation as described in
<a data-cite="VC-DATA-MODEL-2.0#securing-verifiable-credentials">Securing Verifiable Credentials</a>.
      </p>
    </section>
  </section>
  </section>

  <section>
    <h2>Verification Algorithm</h2>
    <p>
This specification might be used with many different key discovery protocols.
Therefore, discovery of verification keys is described in <a href="#key_discovery"></a>,
and is assumed to have succeeded prior to beginning the verification process.
    </p>
    <p>
As a general rule, verifiers SHOULD strive to minimize the processing of untrusted data.
This includes minimizing any processing of the protected header, unprotected header, or payload as part of the key discovery procedures.
    </p>

    <p>
When verifying a credential or presentation secured with SD-JWT, the algorithm defined in
[[SD-JWT] for
  Verification of the SD-JWT
MUST be followed.
    </p>

    <p>
When verifying a credential or presentation secured with COSE_Sign1, the algorithm defined in
<a data-cite="RFC9052#section-4.4">
Signing and Verification Process
</a> MUST be followed.
    </p>

    <p>
After verification has succeeded, additional validation checks SHOULD be performed.
    </p>

  </section>

  <section>
    <h2>Validation Algorithm</h2>

    <p>
All claims expected for the <code>typ</code> MUST be present.
All claims that are understood MUST be evaluated according the verifier's validation policies.
All claims that are not understood MUST be ignored.
    </p>

    <p>
The verified payload MUST be a well formed compact JSON-LD document, as described in
<a data-cite="VC-DATA-MODEL-2.0/#conformance">Verifiable Credentials Data Model v2.0</a>.
    </p>

    <p>
Schema extension mechanisms such as <code>credentialSchema</code> SHOULD be checked.
If the extension mechanism <code>type</code> is not understood,
this property MUST be ignored.
    </p>

    <p>
Status extension mechanisms such as <code>credentialStatus</code> SHOULD be checked.
If the extension mechanism <code>type</code> is not understood,
this property MUST be ignored.
    </p>

    <p>
Based on the validation policy of the verifier and the type of credentials and type of securing mechanism,
additional validation checks might be applied. For example, dependencies between multiple credentials,
ordering or timing information associated with multiple credentials, and/or multiple presentations
could cause an otherwise valid credential or presentation to be considered invalid.
    </p>
  </section>
</body>

</html>
