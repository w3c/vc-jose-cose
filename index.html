<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
    <title>Securing Verifiable Credentials using JOSE and COSE</title>
    <script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove"></script>
    <script class="remove" src="https://cdn.jsdelivr.net/gh/w3c/respec-vc@3.3.5/dist/main.js"></script>
    <script class="remove">
        // See https://github.com/w3c/respec/wiki/ for how to configure
        // ReSpec
        var respecConfig = {
            group: "vc",

            // specification status (e.g., WD, NOTE, etc.). If in doubt use
            // ED.
            specStatus: "CR",
            crEnd: "2024-05-25",

            // the specification's short name, as in
            // http://www.w3.org/TR/short-name/
            shortName: "vc-jose-cose",

            // if you wish the publication date to be other than today, set
            // this
            // publishDate: "2024-04-25",

            implementationReportURI: "https://w3c.github.io/vc-jose-cose-test-suite/",
            // errata:  "https://w3c.github.io/vc-data-model/errata.html",

            // if there is a previously published draft, uncomment this and
            // set its YYYY-MM-DD date and its maturity status
            previousPublishDate: "2023-07-10",
            previousMaturity: "WD",

            // extend the bibliography entries localBiblio: vcwg.localBiblio,
            doJsonLd: true,

            // Uncomment these to use the respec extension that generates a
            //   list of normative statements: preProcess: [], postProcess:
            //   [],

            github: "https://github.com/w3c/vc-jose-cose/",
            includePermalinks: false,

            // if there a publicly available Editor's Draft, this is the link
            edDraftURI: "https://w3c.github.io/vc-jose-cose/",

            // editors, add as many as you like only "name" is required
            editors: [
                {
                    name: "Michael Jones",
                    url: "https://self-issued.info/",
                    company: "Self-Issued Consulting",
                    w3cid: 38745,
                },
                {
                    name: "Michael Prorock",
                    company: "Mesur.io", companyURL: "https://mesur.io/",
                    w3cid: 130636
                },
                {
                    name: "Gabe Cohen",
                    url: "https://github.com/decentralgabe",
                    company: "Block",
                    companyURL: "https://www.tbd.website",
                    w3cid: 116851
                }
            ],
            // authors, add as many as you like. This is optional, uncomment
            // if you have authors as well as editors. only "name" is
            // required. Same format as editors.
            authors: [],
            formerEditors: [],

            maxTocLevel: 3,
            inlineCSS: true,
            postProcess: [window.respecVc.createVcExamples],
            license: "w3c-software-doc",
            xref: ["INFRA", "VC-DATA-MODEL-2.0", "CONTROLLER-DOCUMENT"],
            otherLinks: [{
                key: "Related Documents",
                data: [{
                    value: "Verifiable Credentials Data Model v2.0",
                    href: "https://www.w3.org/TR/vc-data-model-2.0/"
                }, {
                    value: "Controller Documents 1.0",
                    href: "https://www.w3.org/TR/controller-document/"
                }]
            }],
            localBiblio: {
                "SD-JWT": {
                    title: "Selective Disclosure for JWTs (SD-JWT)",
                    href: "https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt",
                    authors: ["Daniel Fett", "Kristina Yasuda", "Brian Campbell"],
                    status: "Internet-Draft",
                    publisher: "IETF"
                },
                "SD-JWT-VC": {
                    title: "SD-JWT-based Verifiable Credentials (SD-JWT VC)",
                    href: "https://datatracker.ietf.org/doc/html/draft-ietf-oauth-sd-jwt-vc",
                    authors: ["Oliver Terbu", "Daniel Fett", "Brian Campbell"],
                    status: "Internet-Draft",
                    publisher: "IETF"
                },
                "JOSE-REGISTRIES": {
                    title: "The JSON Object Signing and Encryption (JOSE) Registries",
                    href: "https://www.iana.org/assignments/jose",
                    authors: ["The Internet Assigned Numbers Authority"],
                    status: "REC",
                    publisher: "The Internet Assigned Numbers Authority"
                },
                "SP-800-122": {
                    title: "Guide to Protecting the Confidentiality of Personally Identifiable Information (PII)",
                    href: "https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-122.pdf",
                    authors: ["Erika McCallister", "Tim Grance", "Karen Scarfone"],
                    status: "Special Publication 800-122",
                    publisher: "NIST"
                },
            }
        };
    </script>
</head>

<body>
<section id="abstract">
    <p>
        This specification defines how to secure credentials and presentations
        conforming to the Verifiable Credential data model [[VC-DATA-MODEL-2.0]]
        with JSON Object Signing and Encryption (<a href="https://datatracker.ietf.org/wg/jose/about/">JOSE</a>),
        Selective Disclosure for JWTs [[SD-JWT]],
        and CBOR Object Signing and Encryption (COSE) [[RFC9052]].
        This enables the Verifiable Credential data model
        [[VC-DATA-MODEL-2.0]] to be implemented with standards
        for signing and encryption that are widely adopted.
    </p>
</section>
<section id="sotd">
    <p>
        The Working Group is actively seeking implementation feedback for this
        specification. In order to exit the Candidate Recommendation phase, the
        Working Group has set the requirement of at least two independent
        implementations for each mandatory feature in the specification. For details
        on the conformance testing process, see the test suite listed in the
        <a href="https://w3c.github.io/vc-jose-cose-test-suite/">
            implementation report</a>.
    </p>
</section>

<section id="introduction">
    <h2 id="section-introduction">Introduction</h2>
    <p>
        This specification defines how to secure media types
        expressing Verifiable Credentials and Verifiable Presentations
        as described in [[VC-DATA-MODEL-2.0]] using approaches
        defined by the JOSE, OAuth, and COSE working groups at the IETF.
        This includes JSON Web Signature (JWS) [[RFC7515]],
        Selective Disclosure for JWTs [[SD-JWT]],
        and CBOR Object Signing and Encryption (COSE) [[RFC9052]].
        It uses content types [[RFC6838]]
        to distinguish between the data types of unsecured documents
        conforming to [[VC-DATA-MODEL-2.0]]
        and the data types of secured documents conforming to [[VC-DATA-MODEL-2.0]].
    </p>
    <p>
        JSON Web Signature (JWS) [[RFC7515]] defines a standard means of
        digitally signing documents, including JSON documents,
        using JSON-based data structures.
        It provides a means to ensure the integrity, authenticity,
        and non-repudiation of the information contained in the document.
        Selective Disclosure for JWTs (SD-JWT) [[SD-JWT]] builds on JWS by also
        providing a mechanism enabling selective disclosure of document elements.
        These properties make JWS and SD-JWT especially well suited to
        securing documents conforming to [[VC-DATA-MODEL-2.0]].
    </p>
    <p>
        CBOR Object Signing and Encryption (COSE) [[RFC9052]] defines
        a standard means of representing digitally signed data structures
        using Concise Binary Object Representation (CBOR) [[RFC8949]].
        Like JWS, COSE provides a standardized way to secure the
        integrity, authenticity, and confidentiality of information.
        It offers a flexible and extensible set of
        cryptographic options, allowing for a wide range of algorithms
        to be used for signing and encryption.
    </p>
    <p>
        COSE supports two main operations: signing and encryption. For
        signing, COSE allows the creation of digital signatures over
        CBOR data using various algorithms such as RSA, ECDSA, and
        EdDSA. These signatures provide assurance of data integrity and
        authenticity. COSE also supports encryption, enabling the
        confidentiality of CBOR data by encrypting it with symmetric or
        asymmetric encryption algorithms.
    </p>

  <section id="conformance">
    <section>
        <h2 id="conformance-classes">Conformance Classes</h2>
        <p>
            A <dfn>conforming JWS document</dfn> is one that conforms to all of the
            "MUST" statements in Section <a href="#secure-with-jose"></a>.
        </p>
        <p>
            A <dfn>conforming JWS issuer implementation</dfn> produces
            [=conforming JWS documents=] and MUST secure them as described in Section
            <a href="#secure-with-jose"></a>.
        <p>
            A <dfn>conforming JWS verifier implementation</dfn> verifies
            [=conforming JWS documents=] as described in Section
            <a href="#secure-with-jose"></a>.
        </p>
        <p>
            A <dfn>conforming SD-JWT document</dfn> is one that conforms to all of the
            "MUST" statements in Section <a href="#secure-with-sd-jwt"></a>.
        </p>
        <p>
            A <dfn>conforming SD-JWT issuer implementation</dfn> produces
            [=conforming SD-JWT documents=] and MUST secure them as described in Section
            <a href="#secure-with-sd-jwt"></a>.
        <p>
            A <dfn>conforming SD-JWT verifier implementation</dfn> verifies
            [=conforming SD-JWT documents=] as described in Section
            <a href="#secure-with-sd-jwt"></a>.
        </p>
        <p>
            A <dfn>conforming COSE document</dfn> is one that conforms to all of the
            "MUST" statements in Section <a href="#secure-with-cose"></a>.
        </p>
        <p>
            A <dfn>conforming COSE issuer implementation</dfn> produces
            [=conforming COSE documents=] and MUST secure them as described in Section
            <a href="#secure-with-cose"></a>.
        </p>
        <p>
            A <dfn>conforming COSE verifier implementation</dfn> verifies
            [=conforming COSE documents=] as described in Section
            <a href="#secure-with-cose"></a>.
        </p>
    </section>
      <section>
          <h2 id="securing-verifiable-credentials">Securing Verifiable Credentials</h2>
          <p>
              The <a data-cite="VC-DATA-MODEL-2.0#securing-mechanism-specifications"></a> describes
              the approach taken by this specification to secure JSON and CBOR
              claims by <i>applying an <code>enveloping proof</code></i>.
          </p>
          <p>
              This specification defines how to secure different data structures
              using various <code>enveloping proof</code> mechanisms:</p>
          <dl>
              <dt>JSON Web Token (JWT):</dt>
              <dd>A JWT secures a JWT Claim Set, in its entirety. A JWT Claim Set
                  is a JSON object containing one or more claims about an entity
                  (typically the subject of the JWT). If any part of the JWT Claim
                  Set is to be revealed, all claims in that set must be revealed;
                  there is no option to reveal (or conceal) <i>some</i> of the
                  claims while concealing (or revealing) the others.</dd>
              <dt>Selective Disclosure JSON Web Token (SD-JWT): </dt>
              <dd>An SD-JWT secures a JSON Claim Set, similar to a JWT securing
                  a JWT Claim Set, but with the added capabilities of selectively
                  revealing or withholding parts of the JSON Claim Set. A JSON
                  Claim Set is one or more claims about an entity (typically the
                  subject of the SD-JWT).</dd>

              <dt>CBOR Object Signing and Encryption (COSE):</dt>
              <dd>COSE secures CBOR (Concise Binary Object Representation) data
                  structures. CBOR is a binary data format that is more compact than
                  JSON and is designed for constrained environments.</dd>
          </dl>

          <p>In the context of Verifiable Credentials:</p>
          <ul>
              <li>When using JWTs, the Verifiable Credential or Presentation is
                  encoded as a JSON Web Token Claim Set.</li>
              <li>When using SD-JWTs, the Verifiable Credential or Presentation
                  is encoded as a JSON Claim Set with Selective Disclosure features.</li>
              <li>When using COSE, the Verifiable Credential or Presentation is
                  encoded as a CBOR data structure.</li>
          </ul>
          <p>
              In all cases, the underlying data model of the Verifiable Credential
              or Presentation remains consistent with the [[VC-DATA-MODEL-2.0]],
              but the encoding and security mechanisms differ.</p>
          <p>
              The normative statements in <a data-cite="VC-DATA-MODEL-2.0#securing-mechanisms">
              Securing Mechanisms</a> apply to securing
              <code>application/vc-ld+jwt</code> and
              <code>application/vp-ld+jwt</code>,
              <code>application/vc-ld+sd-jwt</code> and
              <code>application/vp-ld+sd-jwt</code>,
              <code>application/vc-ld+cose</code> and
              <code>application/vp-ld+cose</code>.
          </p>
          <section>
              <h2>JWT Format and Requirements</h2>
              <p>
                  JSON Web Token implementers are advised to review <a data-cite="RFC7519#section-8">Implementation
                  Requirements</a>.
              </p>
              <p>
                  Issuers, Holders, and Verifiers of JWTs MUST understand the
                  effect of the JSON Web Token header parameter setting of
                  <code>"alg": "none"</code> when using JSON Web Tokens to
                  secure [[[VC-DATA-MODEL-2.0]]] [[VC-DATA-MODEL-2.0]]. When
                  content types from the [[[VC-DATA-MODEL-2.0]]]
                  [[VC-DATA-MODEL-2.0]] are secured using JSON Web Tokens, the
                  header parameter setting of <code>"alg": "none"</code>
                  is used to communicate that a Verifiable Credential or
                  Verifiable Presentation encoded as a JWT Claims Set has no
                  integrity protection.
              </p>
              <p>
                  Issuers, Holders, and Verifiers MUST ignore all JWT Claim Sets that
                  have no integrity protection.
              </p>
              <p>
                  The JWT Claim Names <code>vc</code> and <code>vp</code>
                  MUST NOT be present in any JWT Claim Set.
              </p>
          </section>
          <section>
              <h2>SD-JWT Format and Requirements</h2>
              <p>
                  This specification uses Selective Disclosure for JWTs (SD-JWT) as
                  defined in the IETF draft [[SD-JWT]].
                  Implementers should refer to this draft for the full details of the
                  SD-JWT format and processing requirements.
              </p>
              <ul>
                  <li>An SD-JWT consists of three main parts: the
                      SD-JWT itself, optional disclosures, and an optional KB-JWT (Key
                      Binding JWT). These parts are separated by tilde (~) characters.</li>

                  <li>If the KB-JWT is not present, the SD-JWT must end
                      with a tilde (~) character. This is crucial for correct parsing and
                      processing of the SD-JWT.</li>

                  <li>Selective disclosure is achieved through the use of
                      disclosure objects. These are base64url-encoded JSON arrays
                      containing the digest of the disclosed claim, the claim name, and
                      the claim value.</li>

                  <li>Each disclosable claim is combined with a salt value
                      before hashing to prevent dictionary attacks.</li>
              </ul>
          </section>
      </section>

  </section>

</section>

<section>
    <h3 id="terminology">Terminology</h3>
    <div data-include="./terms.html"></div>
</section>

<section>
    <h2 id="securing-the-vc-data-model">Securing the VC Data Model</h2>
    <p>
        This section outlines how to secure documents conforming
        to [[VC-DATA-MODEL-2.0]] using JOSE, SD-JWT, and COSE.
    </p>
    <p>
        Documents conforming to [[VC-DATA-MODEL-2.0]],
        and their associated media types, rely on
        JSON-LD, which is an extensible format for describing
        linked data; see <a href="https://www.w3.org/TR/json-ld11/#relationship-to-rdf">JSON-LD Relationship to RDF</a>.
    </p>
    <p>
        A benefit to this approach is that payloads can be made to conform
        directly to [[VC-DATA-MODEL-2.0]] without any mappings or
        transformation, while at the same time supporting registered
        header parameters and claims that are understood in the context of JOSE, SD-JWT, and COSE.
    </p>
    <p>
        It is RECOMMENDED that media types be used to distinguish <a data-cite="VC-DATA-MODEL-2.0#credentials">verifiable
        credentials</a>
        and <a data-cite="VC-DATA-MODEL-2.0#presentations">verifiable presentations</a> from other kinds of secured JSON
        or CBOR.
    </p>
    <p>
        The most specific media type (or subtype) available SHOULD be used, instead of
        more generic media types (or supertypes). For example, rather than the general
        <code>application/sd-jwt</code>, <code>application/vc-ld+sd-jwt</code>
        SHOULD be used, unless there is a more specific media type that would even
        better identify the secured envelope format.
    </p>
    <p>
        If implementations do not know which media type to use, media types defined in this specification MUST be used.
    </p>

    <section id="secure-with-jose">
        <h2 id="with-jose">With JOSE</h2>
        <section>
            <h2 id="securing-with-jose">Securing JSON-LD Verifiable Credentials with JOSE</h2>
            <p>
                This section details how to use JOSE to secure verifiable credentials conforming
                to [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                A [=conforming JWS issuer implementation=] MUST use [[RFC7515]] to secure this media type.
                The unsecured verifiable credential is the unencoded JWS payload.
            </p>
            <p>
                The <code>typ</code> header parameter SHOULD be <code>vc-ld+jwt</code>.
                When present, the <code>cty</code> header parameter SHOULD be <code>vc</code>.
                See <a data-cite="RFC7515#section-4.1">Registered Header Parameter Names</a>
                for additional details regarding usage of <code>typ</code> and
                <code>cty</code>.
            </p>
            <p>
                A [=conforming JWS verifier implementation=] MUST use [[RFC7515]] to verify [=conforming JWS documents=]
                that use this media type.
            </p>
	    <p>
	      To encrypt a secured [=verifiable credential=]
	      when transmitting over an insecure channel,
	      implementers MAY use JSON Web Encryption (JWE) [[RFC7516]]
	      by nesting the secured [=verifiable credential=]
	      as the plaintext payload of a JWE,
	      per the description of Nested JWTs in [[RFC7519]].
	    </p>
            <pre class="example nohighlight vc" data-vc-tabs="jose" title="A simple example of a verifiable credential secured with JOSE">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "http://university.example/credentials/1872",
  "type": [
    "VerifiableCredential",
    "ExampleAlumniCredential"
  ],
  "issuer": "https://university.example/issuers/565049",
  "validFrom": "2010-01-01T19:23:24Z",
  "credentialSchema": {
    "id": "https://example.org/examples/degree.json",
    "type": "JsonSchema"
  },
  "credentialSubject": {
    "id": "did:example:123",
    "degree": {
      "type": "BachelorDegree",
      "name": "Bachelor of Science and Arts"
    }
  }
}
        </pre>
            <p>
                See <a
                    data-cite="VC-DATA-MODEL-2.0#example-a-simple-example-of-the-contents-of-a-verifiable-credential"></a>
                for more details regarding this example.
            </p>
        </section>

        <section>
            <h2 id="securing-vps-with-jose">Securing JSON-LD Verifiable Presentations with JOSE</h2>
            <p>
                This section details how to use JOSE to secure verifiable presentations conforming
                to [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                A [=conforming JWS issuer implementation=] MUST use [[RFC7515]] to secure this media type.
                The unsecured verifiable presentation is the unencoded JWS payload.
            </p>
            <p>
                The <code>typ</code> header parameter SHOULD be <code>vp-ld+jwt</code>.
                When present, the <code>cty</code> header parameter SHOULD be <code>vp</code>.
                See <a data-cite="RFC7515#section-4.1">Registered Header Parameter Names</a>
                for additional details regarding usage of <code>typ</code> and
                <code>cty</code>.
            </p>
            <p>
                A [=conforming JWS verifier implementation=] MUST use [[RFC7515]] to verify [=conforming JWS documents=]
                that use this media type.
            </p>
            <p>
                Verifiable Credentials secured in <a data-cite="VC-DATA-MODEL-2.0/#verifiable-presentations">
                verifiable presentations</a> MUST use the <a 
                data-cite="VC-DATA-MODEL-2.0/#defn-EnvelopedVerifiableCredential">Enveloped Verifiable
                Credential</a> type defined by the [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                Verifiable Presentations in <a data-cite="VC-DATA-MODEL-2.0/#verifiable-presentations">
                verifiable presentations</a> MUST use the <a
                    data-cite="VC-DATA-MODEL-2.0/#defn-EnvelopedVerifiablePresentation">Enveloped Verifiable
                Presentation</a> type defined by the [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                Credentials in verifiable presentations MUST be secured.
                These credentials are secured using JWS in this case.
            <p>
	    <p>
	      To encrypt a secured [=verifiable presentation=]
	      when transmitting over an insecure channel,
	      implementers MAY use JSON Web Encryption (JWE) [[RFC7516]]
	      by nesting the secured [=verifiable presentation=]
	      as the plaintext payload of a JWE,
	      per the description of Nested JWTs in [[RFC7519]].
	    </p>

            <pre class="example nohighlight vc" data-vc-tabs="jose"
                 title="A simple example of a verifiable presentation secured with JOSE with the EnvelopedVerifiableCredential type">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "type": "VerifiablePresentation",
  "verifiableCredential": [{
    "@context": ["https://www.w3.org/ns/credentials/v2"],
    "type": ["EnvelopedVerifiableCredential"],
    "id": "data:application/vc-ld+jwt,eyJraWQiOiJFeEhrQk1XOWZtYmt2VjI2Nm1ScHVQMnNVWV9OX0VXSU4xbGFwVXpPOHJvIiwiYWxnIjoiRVMzODQifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiaWQiOiJodHRwOi8vdW5pdmVyc2l0eS5leGFtcGxlL2NyZWRlbnRpYWxzLzE4NzIiLCJ0eXBlIjpbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwiRXhhbXBsZUFsdW1uaUNyZWRlbnRpYWwiXSwiaXNzdWVyIjoiaHR0cHM6Ly91bml2ZXJzaXR5LmV4YW1wbGUvaXNzdWVycy81NjUwNDkiLCJ2YWxpZEZyb20iOiIyMDEwLTAxLTAxVDE5OjIzOjI0WiIsImNyZWRlbnRpYWxTY2hlbWEiOnsiaWQiOiJodHRwczovL2V4YW1wbGUub3JnL2V4YW1wbGVzL2RlZ3JlZS5qc29uIiwidHlwZSI6Ikpzb25TY2hlbWEifSwiY3JlZGVudGlhbFN1YmplY3QiOnsiaWQiOiJkaWQ6ZXhhbXBsZToxMjMiLCJkZWdyZWUiOnsidHlwZSI6IkJhY2hlbG9yRGVncmVlIiwibmFtZSI6IkJhY2hlbG9yIG9mIFNjaWVuY2UgYW5kIEFydHMifX19.d2k4O3FytQJf83kLh-HsXuPvh6yeOlhJELVo5TF71gu7elslQyOf2ZItAXrtbXF4Kz9WivNdztOayz4VUQ0Mwa8yCDZkP9B2pH-9S_tcAFxeoeJ6Z4XnFuL_DOfkR1fP"
  }]
}
      </pre>
            <p>
                See <a data-cite="VC-DATA-MODEL-2.0#enveloped-verifiable-credentials"></a> for more
                details regarding this example.
            </p>

             <pre class="example nohighlight vc" data-vc-tabs="jose"
                 title="A simple example of a verifiable presentation secured with JOSE with the EnvelopedVerifiablePresentation type">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "type": "EnvelopedVerifiablePresentation",  
  "id": "data:application/vp-ld+jwt,eyJraWQiOiJFeEhrQk1XOWZtYmt2VjI2Nm1ScHVQMnNVWV9OX0VXSU4xbGFwVXpPOHJvIiwiYWxnIjoiRVMzODQifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiaWQiOiJodHRwOi8vdW5pdmVyc2l0eS5leGFtcGxlL2NyZWRlbnRpYWxzLzE4NzIiLCJ0eXBlIjpbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwiRXhhbXBsZUFsdW1uaUNyZWRlbnRpYWwiXSwiaXNzdWVyIjoiaHR0cHM6Ly91bml2ZXJzaXR5LmV4YW1wbGUvaXNzdWVycy81NjUwNDkiLCJ2YWxpZEZyb20iOiIyMDEwLTAxLTAxVDE5OjIzOjI0WiIsImNyZWRlbnRpYWxTY2hlbWEiOnsiaWQiOiJodHRwczovL2V4YW1wbGUub3JnL2V4YW1wbGVzL2RlZ3JlZS5qc29uIiwidHlwZSI6Ikpzb25TY2hlbWEifSwiY3JlZGVudGlhbFN1YmplY3QiOnsiaWQiOiJkaWQ6ZXhhbXBsZToxMjMiLCJkZWdyZWUiOnsidHlwZSI6IkJhY2hlbG9yRGVncmVlIiwibmFtZSI6IkJhY2hlbG9yIG9mIFNjaWVuY2UgYW5kIEFydHMifX19.d2k4O3FytQJf83kLh-HsXuPvh6yeOlhJELVo5TF71gu7elslQyOf2ZItAXrtbXF4Kz9WivNdztOayz4VUQ0Mwa8yCDZkP9B2pH-9S_tcAFxeoeJ6Z4XnFuL_DOfkR1fP"
}
      </pre>
            <p>
                See <a data-cite="VC-DATA-MODEL-2.0#enveloped-verifiable-presentations"></a> for more
                details regarding this example.
            </p>

            <p>
                Implementations MUST support the JWS compact serialization.
                Use of the JWS JSON serialization is NOT RECOMMENDED.
            </p>
        </section>
        <section class="appendix informative">
            <h2 id="jose-header-parameters-jwt-claims">JOSE Header Parameters and JWT Claims</h2>

            <p>
                When present in the <a data-cite="RFC7515#section-4">JOSE Header</a> or the
                <a data-cite="RFC7519#section-4">JWT Claims Set</a>, members registered in the
                IANA
                <a href="https://www.iana.org/assignments/jwt/jwt.xhtml">JSON Web Token Claims</a>
                registry or the IANA
                <a href="https://www.iana.org/assignments/jose/jose.xhtml">JSON Web Signature and Encryption Header
                    Parameters</a>
                registry are to be interpreted as defined by the specifications referenced in
                the registries.
            </p>
            <p>
                The normative statements in
                <a data-cite="RFC7515#section-4.1">Registered Header Parameter Names</a>,
                <a data-cite="RFC7519#section-5">JOSE Header</a>, and
                <a data-cite="RFC7519#section-5.3">Replicating Claims as Header Parameters</a>
                apply to securing credentials and presentations.
            </p>
            <p>
                The unencoded JOSE Header is JSON (`application/json`), not JSON-LD
                (`application/ld+json`).
            </p>
            <p>
                It is RECOMMENDED to use the IANA
                <a href="https://www.iana.org/assignments/jwt/jwt.xhtml">JSON Web Token Claims</a>
                registry and the IANA
                <a href="https://www.iana.org/assignments/jose/jose.xhtml">JSON Web Signature and Encryption Header
                    Parameters</a>
                registry to identify any claims and header parameters that might be confused
                with members defined by [[[VC-DATA-MODEL-2.0]]] [[VC-DATA-MODEL-2.0]]. These include but are not limited
                to: <code>iss</code>, <code>kid</code>, <code>alg</code>, <code>iat</code>,
                <code>exp</code>, and <code>cnf</code>.
            </p>
            <p>
                When the <code>iat</code> (Issued At) and/or
		<code>exp</code> (Expiration Time) JWT claims are present, they
                represent the issuance and expiration time of the signature, respectively. Note
                that these are different from the <code>validFrom</code> and
                <code>validUntil</code> properties defined in
                <a data-cite="VC-DATA-MODEL-2.0#validity-period">Validity Period</a>, which
                represent the validity of the data that is being secured.
		Use of the <code>nbf</code> (Not Before) claim is NOT RECOMMENDED,
		as it makes little sense to attempt to assign a future date to
		a signature.
            </p>
            <p>
                The claims and security provided by this specification are independent of the
                data secured and semantics provided by the [[[VC-DATA-MODEL-2.0]]] [[VC-DATA-MODEL-2.0]]. This means
                that while the security features of this specification ensure data integrity and
                authenticity, they do not dictate the interpretation of claim data.
            </p>
            <p>
                Implementers SHOULD avoid setting JWT claims to values that conflict with the
                values of verifiable credential properties when a claim and property pair refer
                to the same conceptual entity, especially with pairs such as `iss` and `issuer`,
                `jti` and `id`, and `sub` and `credentialSubject.id`. For example, JWK claim
                `iss` should not be set to a value which conflicts with the value of verifiable
                credential property `issuer`.
            </p>
            <p>
                The JWT Claim Names <code>vc</code> and <code>vp</code> MUST NOT be present.
            </p>
            <p>
                Additional members may be present as header parameters and claims. If they are
                not understood, they MUST be ignored.
            </p>
        </section>
    </section>

    <section id="secure-with-sd-jwt">
        <h2 id="with-sd-jwt">With SD-JWT</h2>
        <section>
            <h2 id="securing-with-sd-jwt">Securing JSON-LD Verifiable Credentials with SD-JWT</h2>
            <p>
                This section details how to use JOSE to secure verifiable credentials conforming
                to [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                A [=conforming SD-JWT issuer implementation=] MUST use [[[SD-JWT]]] [[SD-JWT]] to secure
                this media type. The unsecured [=verifiable credential=] is the input JSON
                claim set. The Issuer then converts the input JSON claim set (i.e., the
                unsecured [=verifiable credential=]) into an SD-JWT payload according to
                <a data-cite="SD-JWT#section-6.1">SD-JWT issuance instructions</a>.
            </p>
            <p>
                The <code>typ</code> header parameter SHOULD be <code>vc-ld+sd-jwt</code>.
                When present, the <code>cty</code> header parameter SHOULD be <code>vc</code>.
                See <a data-cite="RFC7515#section-4.1">Registered Header Parameter Names</a>
                for additional details regarding usage of <code>typ</code> and
                <code>cty</code>.
            </p>
            <p>
                A [=conforming SD-JWT verifier implementation=] MUST use [[SD-JWT]] to verify [=conforming JWS
                documents=] that use this media type.
            </p>
            <p>
                When securing [=verifiable credentials=] with [[SD-JWT]] implementers MUST ensure that
                properties necessary for the validation and verification of a credential are NOT selectively
                disclosable (i.e., such properties MUST be disclosed). These properties include but are not
                limited to <a data-cite="VC-DATA-MODEL-2.0#contexts"><code>@context</code></a>,
                <a data-cite="VC-DATA-MODEL-2.0#types"><code>type</code></a>,
                <a data-cite="VC-DATA-MODEL-2.0#status"><code>credentialStatus</code></a>
                and <a data-cite="VC-DATA-MODEL-2.0#data-schemas"><code>credentialSchema</code></a>,
                and <a data-cite="VC-DATA-MODEL-2.0#integrity-of-related-resources"><code>relatedResource</code></a>.
            </p>
	    <p>
	      To encrypt a secured [=verifiable credential=]
	      when transmitting over an insecure channel,
	      implementers MAY use JSON Web Encryption (JWE) [[RFC7516]]
	      by nesting the secured [=verifiable credential=]
	      as the plaintext payload of a JWE,
	      per the instructions in Section 11.2 of [[SD-JWT]].
	    </p>

            <pre class="example nohighlight vc" data-vc-tabs="sd-jwt"
                 title="A simple example of a verifiable credential secured with SD-JWT">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "http://university.example/credentials/1872",
  "type": [
    "VerifiableCredential",
    "ExampleAlumniCredential"
  ],
  "issuer": "https://university.example/issuers/565049",
  "validFrom": "2010-01-01T19:23:24Z",
  "credentialSchema": {
    "id": "https://example.org/examples/degree.json",
    "type": "JsonSchema"
  },
  "credentialSubject": {
    "id": "did:example:123",
    "degree": {
      "type": "BachelorDegree",
      "name": "Bachelor of Science and Arts"
    }
  }
}
        </pre>
            <p>
                See <a
                    data-cite="VC-DATA-MODEL-2.0#example-a-simple-example-of-the-contents-of-a-verifiable-credential"></a>
                for more details regarding this example.
            </p>
        </section>

        <section>
            <h2 id="securing-vps-sd-jwt">Securing JSON-LD Verifiable Presentations with SD-JWT</h2>
            <p>
                This section details how to use SD-JWT to secure verifiable presentations conforming
                to [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                A [=conforming SD-JWT issuer implementation=] MUST use [[SD-JWT]] to secure this media type.
                The unsecured verifiable presentation is the unencoded SD-JWT payload.
            </p>
            <p>
                The <code>typ</code> header parameter SHOULD be <code>vp-ld+sd-jwt</code>.
                When present, the <code>cty</code> header parameter SHOULD be <code>vp</code>.
                See <a data-cite="RFC7515#section-4.1">Registered Header Parameter Names</a>
                for additional details regarding usage of <code>typ</code> and
                <code>cty</code>.
            </p>
            <p>
                A [=conforming SD-JWT verifier implementation=] MUST use [[SD-JWT]] to verify [=conforming JWS
                documents=] that use this media type.
            </p>
            <p>
                Verifiable Credentials secured in <a data-cite="VC-DATA-MODEL-2.0/#verifiable-presentations">
                verifiable presentations</a> MUST use the <a 
                data-cite="VC-DATA-MODEL-2.0/#defn-EnvelopedVerifiableCredential">Enveloped Verifiable
                Credential</a> type defined by the [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                Verifiable Presentations in <a data-cite="VC-DATA-MODEL-2.0/#verifiable-presentations">
                verifiable presentations</a> MUST use the <a
                    data-cite="VC-DATA-MODEL-2.0/#defn-EnvelopedVerifiablePresentation">Enveloped Verifiable
                Presentation</a> type defined by the [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                Credentials in verifiable presentations MUST be secured.
                These credentials are secured using SD-JWT in this case.
            <p>
            <p>
                When securing [=verifiable credentials=] with [[SD-JWT]] implementers MUST ensure that
                properties necessary for the validation and verification of a credential are NOT selectively
                disclosable (i.e., such properties MUST be disclosed). These properties include but are not
                limited to <a data-cite="VC-DATA-MODEL-2.0#contexts"><code>@context</code></a>,
                <a data-cite="VC-DATA-MODEL-2.0#types"><code>type</code></a>,
                <a data-cite="VC-DATA-MODEL-2.0#status"><code>credentialStatus</code></a>
                and <a data-cite="VC-DATA-MODEL-2.0#data-schemas"><code>credentialSchema</code></a>,
                and <a data-cite="VC-DATA-MODEL-2.0#integrity-of-related-resources"><code>relatedResource</code></a>.
            </p>
	    <p>
	      To encrypt a secured [=verifiable presentation=]
	      when transmitting over an insecure channel,
	      implementers MAY use JSON Web Encryption (JWE) [[RFC7516]]
	      by nesting the secured [=verifiable presentation=]
	      as the plaintext payload of a JWE,
	      per the instructions in Section 11.2 of [[SD-JWT]].
	    </p>

            <pre class="example nohighlight vc" data-vc-tabs="sd-jwt"
                 title="A simple example of a verifiable presentation secured with SD-JWT using the EnvelopedVerifiableCredential type">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "type": "VerifiablePresentation",
  "verifiableCredential": [{
    "@context": "https://www.w3.org/ns/credentials/v2",
    "type": "EnvelopedVerifiableCredential",
    "id": "data:application/vc-ld+sd-jwt,eyJraWQiOiJFeEhrQk1XOWZtYmt2VjI2Nm1ScHVQMnNVWV9OX0VXSU4xbGFwVXpPOHJvIiwiYWxnIjoiRVMyNTYifQ.eyJfc2RfYWxnIjoic2hhLTI1NiIsIkBjb250ZXh0IjpbImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy92MiIsImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy9leGFtcGxlcy92MiJdLCJpc3N1ZXIiOiJodHRwczovL3VuaXZlcnNpdHkuZXhhbXBsZS9pc3N1ZXJzLzU2NTA0OSIsInZhbGlkRnJvbSI6IjIwMTAtMDEtMDFUMTk6MjM6MjRaIiwiY3JlZGVudGlhbFNjaGVtYSI6eyJfc2QiOlsiNjVFLVZZbmE3UE5mSGVsUDN6THFwcE5ERXhSLWhjWkhSTnlxN2U0ZVdabyIsIjhJbEwtUGx4Ukt3S0hLaTMtTXhXMjM4d0FkTmQ0NHdabC1iY3NBc2JIQjAiXX0sImNyZWRlbnRpYWxTdWJqZWN0Ijp7ImRlZ3JlZSI6eyJuYW1lIjoiQmFjaGVsb3Igb2YgU2NpZW5jZSBhbmQgQXJ0cyIsIl9zZCI6WyJMVXhqcWtsWS1hdDVSVmFoSXpxM3NJZ015dkdwVDlwdlUwdTRyU2ktMXl3Il19LCJfc2QiOlsiVmxZLW50ZklPOUI5RGRsUWp5U2REMldoVWI0bjc3Zl9HWDZ2U1dLQWpCNCJdfSwiX3NkIjpbIi1iREZ4Um94UUVlcEdjZFl6a250aTVGWXBsUTU5N0djaEdUTGVtLVJSY1UiLCJfREFVZ0xrTF9zVkVtLTBvcE8zaWhpeVFhS0ZzT08xUl9ONk1CUmprOWhFIl19.Kc083RKbBxc3Vr5qR3iEEPp3dKxTa6sPaWNsqtkIw8TvMRf9EZL2ajtgkWSBYzyzOzawOrCXryyp4rMTyI9vfA ~WyJiQ1RTaU9HNUo1VXhPY1QwUlNfd01nIiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~WyJTclNWMS01SjR6cWhOU3N3STIwaHdRIiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyJKX294dDhtUGUtaDl4MkQzc29uT1N3IiwgImlkIiwgImh0dHBzOi8vZXhhbXBsZS5vcmcvZXhhbXBsZXMvZGVncmVlLmpzb24iXQ~WyJDMlpWektmZ185RUh1ajB2S1ExdWJnIiwgInR5cGUiLCAiSnNvblNjaGVtYSJd~WyJ6Szd5QlFPbFhfX2Q0X0VoYUc0Y0pRIiwgImlkIiwgImRpZDpleGFtcGxlOjEyMyJd~WyJ6b1pzRzMzeXBMeVRGMm9aS3ZmMVFnIiwgInR5cGUiLCAiQmFjaGVsb3JEZWdyZWUiXQ~"
  }]
}
      </pre>
            <p>
                See <a data-cite="VC-DATA-MODEL-2.0#enveloped-verifiable-credentials"></a> for more
                details regarding this example.
            </p>

            <pre class="example nohighlight vc" data-vc-tabs="sd-jwt"
                 title="A simple example of a verifiable presentation secured with SD-JWT using the EnvelopedVerifiablePresentation type">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "type": "EnvelopedVerifiablePresentation",
  "id": "data:application/vp-ld+sd-jwt,eyJhbGciOiJFUzM4NCIsImtpZCI6IlVRTV9fblE0UzZCTzhuUTRuT05YeHB4aHRob3lOeGI1M0xZZ1l6LTJBQnMiLCJ0eXAiOiJ2cCtsZCtqc29uK3NkLWp3dCIsImN0eSI6InZwK2xkK2pzb24ifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwidmVyaWZpYWJsZUNyZWRlbnRpYWwiOlt7IkBjb250ZXh0IjpbImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy92MiIsImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy9leGFtcGxlcy92MiJdLCJpc3N1ZXIiOiJodHRwczovL3VuaXZlcnNpdHkuZXhhbXBsZS9pc3N1ZXJzLzU2NTA0OSIsInZhbGlkRnJvbSI6IjIwMTAtMDEtMDFUMTk6MjM6MjRaIiwiY3JlZGVudGlhbFN1YmplY3QiOnsiYWx1bW5pT2YiOnsibmFtZSI6IkV4YW1wbGUgVW5pdmVyc2l0eSIsIl9zZCI6WyJoek9LRzU2cDI5c1ByTGFDNUE4RndFdUczVU05dUlZU1p1cU9YczJlVGJBIl19LCJfc2QiOlsiWVdXVmVDRndxQmk4WDBqSF9jV0NWWU16STNhOHBjTEVYRWZicFNSQVlndyJdfSwiX3NkIjpbIjJJZjhhaUs4REZwVWJ4dEc1cGMwel9SaFJzbm1ybGFRMEhzcTk4WFNyYWsiLCJUeDZ4ZWZMVUdUZUpfYWtVUFdGeHNvbUhobGtWVnpfNzVoaVZ6eWpyYmVzIl19XSwiX3NkIjpbIjd2anl0VVN3ZEJ0MXQ5RktlOVFfS3JIRXhFWGxrTEFaTzBKM0Jpd200dlkiXSwiX3NkX2FsZyI6InNoYS0yNTYiLCJpYXQiOjE3MDY1NjI4NDksImV4cCI6MTczODE4NTI0OSwiY25mIjp7Imp3ayI6eyJrdHkiOiJFQyIsImNydiI6IlAtMzg0IiwiYWxnIjoiRVMzODQiLCJ4IjoidWtEd1U2ZzlQUVRFUWhYaEgyckRZNndMQlg3UHFlUjZBcGlhVHBEUXowcl8tdDl6UXNxem54Z0hEcE5oekZlQyIsInkiOiJMQnhVYnBVdFNGMVVKVTVpYnJIdkpINjBUSG5YMk1xa0xHZGltU1l0UGR4RlkxOEdhcldiS3FZV0djUkZHVE9BIn19fQ.kYD63YtBNYnLUTw6Szf1vs_Ug3UBXhPwCyqpNmPnPDa3rXZQhQLdB1BgaoO8zgQ-c3B41fxaXMnLHYV9-B20uboSpJP0B-2Vre917eQt1cSDswDGA_Ytvn4BSqYVBB2J~WyJFMkFsRzhsY2p0QVFrcllIbjlIbnVRIiwgInR5cGUiLCAiVmVyaWZpYWJsZVByZXNlbnRhdGlvbiJd~WyI5NldYMDRneno4cVZzOVZLU2wwYTVnIiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~WyJaekU2VFVaamtHMW1DWXBKMEhnc0l3IiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyItQ3NsS25GZGFYb2JiQWsyU0JBVGR3IiwgImlkIiwgImRpZDpleGFtcGxlOmViZmViMWY3MTJlYmM2ZjFjMjc2ZTEyZWMyMSJd~WyJuRm1OWl9IczB3WWNoOFdkeTdnQUNRIiwgImlkIiwgImRpZDpleGFtcGxlOmMyNzZlMTJlYzIxZWJmZWIxZjcxMmViYzZmMSJd~"
}
      </pre>
            <p>
                See <a data-cite="VC-DATA-MODEL-2.0#enveloped-verifiable-presentations"></a> for more
                details regarding this example.
            </p>

            <p>
                Implementations MUST support the compact serialization (<code>application/sd-jwt</code>)
                and MAY support the JSON serialization (<code>application/sd-jwt+json</code>).
                If the JSON serialization is used, it is RECOMMENDED that a profile be defined
                to ensure any additional JSON members are understood consistently.
            </p>
        </section>
    </section>

    <section id="secure-with-cose">
        <h2 id="securing-with-cose">With COSE</h2>
        <p>
            COSE [[RFC9052]] is a common approach to encoding and securing
            information using CBOR [[RFC8949]]. Verifiable credentials MAY
            be secured using COSE [[RFC9052]] and SHOULD be identified through
            use of content types as outlined in this section.
        </p>

        <section>
            <h2 id="securing-vcs-with-cose">Securing JSON-LD Verifiable Credentials with COSE</h2>
            <p>
                This section details how to use COSE to secure verifiable credentials conforming
                to [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                A [=conforming COSE issuer implementation=] MUST use COSE_Sign1 as specified in [[RFC9052]] to secure
                this media type.
                The unsecured verifiable credential is the unencoded COSE_Sign1 payload.
            </p>
            <p>
                The <code>typ</code> header parameter, as described in <a data-cite="RFC9596#section-2">COSE "typ" (type) Header Parameter</a>, SHOULD be <code>application/vc-ld+cose</code>.
                When present, the <code>content type (3)</code> header parameter
                SHOULD be <code>application/vc</code>.
                See <a data-cite="RFC9052#section-3.1">Common COSE Header Parameters</a> for additional details.
            </p>
            <p>
                A [=conforming COSE verifier implementation=] MUST use COSE_Sign1 as specified in [[RFC9052]] to verify
                [=conforming COSE documents=] that use this media type.
            </p>
	    <p>
	      To encrypt a secured [=verifiable credential=]
	      when transmitting over an insecure channel,
	      implementers MAY use COSE encryption,
	      as defined in Section 5 of [[RFC9052]],
	      by nesting the secured [=verifiable credential=]
	      as the plaintext payload of an encrypted COSE object.
	    </p>

            <pre class="example nohighlight vc" data-vc-tabs="cose"
                 title="A simple example of a verifiable credential secured with COSE">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "http://university.example/credentials/1872",
  "type": [
    "VerifiableCredential",
    "ExampleAlumniCredential"
  ],
  "issuer": "https://university.example/issuers/565049",
  "validFrom": "2010-01-01T19:23:24Z",
  "credentialSchema": {
    "id": "https://example.org/examples/degree.json",
    "type": "JsonSchema"
  },
  "credentialSubject": {
    "id": "did:example:123",
    "degree": {
      "type": "BachelorDegree",
      "name": "Bachelor of Science and Arts"
    }
  }
}
        </pre>
            <p>
                See <a
                    data-cite="VC-DATA-MODEL-2.0#example-a-simple-example-of-the-contents-of-a-verifiable-credential"></a>
                for more details regarding this example.
            </p>
        </section>
        <section>
            <h2 id="securing-vps-with-cose">Securing JSON-LD Verifiable Presentations with COSE</h2>
            <p>
                This section details how to use COSE to secure verifiable presentations conforming
                to [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                A [=conforming COSE issuer implementation=] MUST use COSE_Sign1 as specified in [[RFC9052]] to secure
                this media type.
                The unsecured verifiable presentation is the unencoded COSE_Sign1 payload.
            </p>
            <p>
                The <code>typ</code> header parameter SHOULD be <code>application/vp-ld+cose</code>.
                When present, the <code>cty</code> header parameter SHOULD be <code>application/vp</code>.
                See <a data-cite="RFC9052#section-3.1">Common COSE Header Parameters</a> for additional details.
            </p>
            <p>
                A [=conforming COSE verifier implementation=] MUST use COSE_Sign1 as specified in [[RFC9052]] to verify
                [=conforming COSE documents=] that use this media type.
            </p>
            <p>
                Verifiable Credentials secured in <a data-cite="VC-DATA-MODEL-2.0/#verifiable-presentations">
                verifiable presentations</a> MUST use the <a 
                data-cite="VC-DATA-MODEL-2.0/#defn-EnvelopedVerifiableCredential">Enveloped Verifiable
                Credential</a> type defined by the [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                Verifiable Presentations in <a data-cite="VC-DATA-MODEL-2.0/#verifiable-presentations">
                verifiable presentations</a> MUST use the <a
                    data-cite="VC-DATA-MODEL-2.0/#defn-EnvelopedVerifiablePresentation">Enveloped Verifiable
                Presentation</a> type defined by the [[VC-DATA-MODEL-2.0]].
            </p>
            <p>
                Credentials in verifiable presentations MUST be secured.
                These credentials are secured using COSE in this case.
            <p>
	    <p>
	      To encrypt a secured [=verifiable presentation=]
	      when transmitting over an insecure channel,
	      implementers MAY use COSE encryption,
	      as defined in Section 5 of [[RFC9052]],
	      by nesting the secured [=verifiable presentation=]
	      as the plaintext payload of an encrypted COSE object.
	    </p>

            <pre class="example nohighlight vc" data-vc-tabs="cose"
                 title="A simple example of a verifiable presentation secured with COSE using the EnvelopedVerifiableCredential type">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "type": "VerifiablePresentation",
  "verifiableCredential": [{
    "@context": "https://www.w3.org/ns/credentials/v2",
    "type": "EnvelopedVerifiableCredential",
    "id": "data:application/vc-ld+sd-jwt,eyJraWQiOiJFeEhrQk1XOWZtYmt2VjI2Nm1ScHVQMnNVWV9OX0VXSU4xbGFwVXpPOHJvIiwiYWxnIjoiRVMyNTYifQ.eyJfc2RfYWxnIjoic2hhLTI1NiIsIkBjb250ZXh0IjpbImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy92MiIsImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy9leGFtcGxlcy92MiJdLCJpc3N1ZXIiOiJodHRwczovL3VuaXZlcnNpdHkuZXhhbXBsZS9pc3N1ZXJzLzU2NTA0OSIsInZhbGlkRnJvbSI6IjIwMTAtMDEtMDFUMTk6MjM6MjRaIiwiY3JlZGVudGlhbFNjaGVtYSI6eyJfc2QiOlsiNWJBeDMteHBmQWxVS0ZJOXNuM2hWQ21wR2trcUlzWmMzLUxiMzNmWmpiayIsIlpjQXZIMDhsdEJySUpmSWh0OF9tS1BfYzNscG5YMWNHclltVG8wZ1lCeTgiXX0sImNyZWRlbnRpYWxTdWJqZWN0Ijp7ImRlZ3JlZSI6eyJuYW1lIjoiQmFjaGVsb3Igb2YgU2NpZW5jZSBhbmQgQXJ0cyIsIl9zZCI6WyJST1Q3MUl0dTNMNlVXWFVqby1oWVdJQjY3bHVPTkVEUlNCaGxEVENxVU9RIl19LCJfc2QiOlsiTUVuZXNnMlhPUk5jY3NCTWVaXzE2MDJneTQwUi00WUJ2VlIweFE4b0Y4YyJdfSwiX3NkIjpbIkVlc2Jiay1mcGZwd2ZMOXdOczFxcjZ0aU43ZnEtSXQzWVM2V3ZCbl9iWG8iLCJab1I1ZGRhckdtZk15NEhuV0xVak5URnFURjNYRjZpdFBnZnlGQkhVX3FVIl19.gw3paxbkLjpi8CTsyRpXKbC7tpVa0q2sWKSD-_dcbuZ1LpZV3oQ8Ifzcm2bE8RY3fmJgbuyA9gbPL3sQBaTzkg ~WyJSeUQxVlB4VHBvbmtPeXZpczkta293IiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~WyJfVjd1eTd3ay1RM3VZd2ZpZ0NvWUVBIiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyJhazdqMTlnYVMtRDJLX2hzY3RVZGNRIiwgImlkIiwgImh0dHBzOi8vZXhhbXBsZS5vcmcvZXhhbXBsZXMvZGVncmVlLmpzb24iXQ~WyJUTjBXaXVZRkhXWkV2ZDZIQUJHQS1nIiwgInR5cGUiLCAiSnNvblNjaGVtYSJd~WyJVMnBzMkxYVERVbVh3MDcxRVBmRUpnIiwgImlkIiwgImRpZDpleGFtcGxlOjEyMyJd~WyJsQ042eTNEaTNDUk9VX3JuXzRENWRnIiwgInR5cGUiLCAiQmFjaGVsb3JEZWdyZWUiXQ~"
  }]
}
      </pre>
            <p>
                See <a data-cite="VC-DATA-MODEL-2.0#enveloped-verifiable-credentials"></a> for more
                details regarding this example.
            </p>

            <pre class="example nohighlight vc" data-vc-tabs="cose"
                 title="A simple example of a verifiable presentation secured with COSE using the EnvelopedVerifiablePresentation type">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "type": "EnvelopedVerifiablePresentation",
  "id": "data:application/vp-ld+sd-jwt,eyJhbGciOiJFUzM4NCIsImtpZCI6IlVRTV9fblE0UzZCTzhuUTRuT05YeHB4aHRob3lOeGI1M0xZZ1l6LTJBQnMiLCJ0eXAiOiJ2cCtsZCtqc29uK3NkLWp3dCIsImN0eSI6InZwK2xkK2pzb24ifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwidmVyaWZpYWJsZUNyZWRlbnRpYWwiOlt7IkBjb250ZXh0IjpbImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy92MiIsImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy9leGFtcGxlcy92MiJdLCJpc3N1ZXIiOiJodHRwczovL3VuaXZlcnNpdHkuZXhhbXBsZS9pc3N1ZXJzLzU2NTA0OSIsInZhbGlkRnJvbSI6IjIwMTAtMDEtMDFUMTk6MjM6MjRaIiwiY3JlZGVudGlhbFN1YmplY3QiOnsiYWx1bW5pT2YiOnsibmFtZSI6IkV4YW1wbGUgVW5pdmVyc2l0eSIsIl9zZCI6WyJoek9LRzU2cDI5c1ByTGFDNUE4RndFdUczVU05dUlZU1p1cU9YczJlVGJBIl19LCJfc2QiOlsiWVdXVmVDRndxQmk4WDBqSF9jV0NWWU16STNhOHBjTEVYRWZicFNSQVlndyJdfSwiX3NkIjpbIjJJZjhhaUs4REZwVWJ4dEc1cGMwel9SaFJzbm1ybGFRMEhzcTk4WFNyYWsiLCJUeDZ4ZWZMVUdUZUpfYWtVUFdGeHNvbUhobGtWVnpfNzVoaVZ6eWpyYmVzIl19XSwiX3NkIjpbIjd2anl0VVN3ZEJ0MXQ5RktlOVFfS3JIRXhFWGxrTEFaTzBKM0Jpd200dlkiXSwiX3NkX2FsZyI6InNoYS0yNTYiLCJpYXQiOjE3MDY1NjI4NDksImV4cCI6MTczODE4NTI0OSwiY25mIjp7Imp3ayI6eyJrdHkiOiJFQyIsImNydiI6IlAtMzg0IiwiYWxnIjoiRVMzODQiLCJ4IjoidWtEd1U2ZzlQUVRFUWhYaEgyckRZNndMQlg3UHFlUjZBcGlhVHBEUXowcl8tdDl6UXNxem54Z0hEcE5oekZlQyIsInkiOiJMQnhVYnBVdFNGMVVKVTVpYnJIdkpINjBUSG5YMk1xa0xHZGltU1l0UGR4RlkxOEdhcldiS3FZV0djUkZHVE9BIn19fQ.kYD63YtBNYnLUTw6Szf1vs_Ug3UBXhPwCyqpNmPnPDa3rXZQhQLdB1BgaoO8zgQ-c3B41fxaXMnLHYV9-B20uboSpJP0B-2Vre917eQt1cSDswDGA_Ytvn4BSqYVBB2J~WyJFMkFsRzhsY2p0QVFrcllIbjlIbnVRIiwgInR5cGUiLCAiVmVyaWZpYWJsZVByZXNlbnRhdGlvbiJd~WyI5NldYMDRneno4cVZzOVZLU2wwYTVnIiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~WyJaekU2VFVaamtHMW1DWXBKMEhnc0l3IiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyItQ3NsS25GZGFYb2JiQWsyU0JBVGR3IiwgImlkIiwgImRpZDpleGFtcGxlOmViZmViMWY3MTJlYmM2ZjFjMjc2ZTEyZWMyMSJd~WyJuRm1OWl9IczB3WWNoOFdkeTdnQUNRIiwgImlkIiwgImRpZDpleGFtcGxlOmMyNzZlMTJlYzIxZWJmZWIxZjcxMmViYzZmMSJd~"
}
      </pre>
            <p>
                See <a data-cite="VC-DATA-MODEL-2.0#enveloped-verifiable-presentations"></a> for more
                details regarding this example.
            </p>            
        </section>
        <section>
            <h2 id="cose-header-param-cwt-claims">COSE Header Parameters and CWT Claims</h2>

            <p>
                When present in the <a data-cite="RFC9052#section-3.1">COSE Header</a> or as
                <a data-cite="RFC8392#section-3">CWT Claims</a>, members registered in the IANA
                <a href="https://www.iana.org/assignments/cwt/cwt.xhtml">CBOR Web Token (CWT) Claims</a>
                registry or the IANA
                <a href="https://www.iana.org/assignments/cose/cose.xhtml">COSE Header Parameters</a>
                registry are to be interpreted as defined by the specifications referenced in
                those registries. CBOR Web Token (CWT) [[?RFC8392]] Claims MAY be included in a
                COSE header parameter, as specified in
                <a href="https://www.ietf.org/archive/id/draft-ietf-cose-cwt-claims-in-headers-10.html">I-D.ietf-cose-cwt-claims-in-headers</a>.
            </p>
            <p>
                The normative statements in
                <a data-cite="RFC9052#section-3.1">Header Parameters</a>,
                <a data-cite="RFC8392#section-3">Claims</a>, and
                <a href="https://www.ietf.org/archive/id/draft-ietf-cose-cwt-claims-in-headers-10.html">CBOR Web Token
                    (CWT) Claims in COSE Headers</a>
                apply to securing credentials and presentations.
            </p>
            <p>
                It is RECOMMENDED to use the IANA
                <a href="https://www.iana.org/assignments/cwt/cwt.xhtml">CBOR Web Token Claims</a>
                registry and the IANA
                <a href="https://www.iana.org/assignments/cose/cose.xhtml">COSE Header Parameters</a>
                registry to identify any claims and header parameters that might be confused
                with members defined by [[[VC-DATA-MODEL-2.0]]] [[VC-DATA-MODEL-2.0]]. These include but are not limited
                to: <code>iss</code>, <code>kid</code>, <code>alg</code>, <code>iat</code>,
                <code>exp</code>, and <code>cnf</code>.
            </p>
            <p>
                When the <code>iat</code> (Issued At) and/or
		<code>exp</code> (Expiration Time) CWT claims are present, they
                represent the issuance and expiration time of the signature, respectively. Note
                that these are different from the <code>validFrom</code> and
                <code>validUntil</code> properties defined in
                <a data-cite="VC-DATA-MODEL-2.0#validity-period">Validity Period</a>, which
                represent the validity of the data that is being secured.
		Use of the <code>nbf</code> (Not Before) claim is NOT RECOMMENDED,
		as it makes little sense to attempt to assign a future date to
		a signature.
            </p>
            <p>
                Additional members may be present as header parameters and claims. If they are
                not understood, they MUST be ignored.
            </p>
        </section>
    </section>
</section>


<section id="key_discovery">
    <h2 id="key-discovery">Key Discovery</h2>

    <p>
        To complete the <a data-cite="VC-DATA-MODEL-2.0#dfn-verify">verification</a> process,
        a <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifier</a> needs to obtain the cryptographic keys used to
        secure the
        <a data-cite="VC-DATA-MODEL-2.0#dfn-credential">credential</a>.
    </p>
    <p>
        There are several different ways to discover the verification keys of
        the <a data-cite="VC-DATA-MODEL-2.0#dfn-issuers">issuers</a>
        and <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">holders</a>.
    </p>


    <section>
        <h2 id="using-header-params-claims-key-discovery">Using Header Parameters and Claims for Key Discovery</h2>
        <p>
            These JOSE header parameters and JWT claims can be used by
            <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifiers</a> to discover verification keys.
        </p>
        <section>
            <h2 id="kid">kid</h2>
            <p>
                If <code>kid</code> is present in the <a data-cite="RFC7515#section-4.1">JOSE Header</a>
                or the <a data-cite="RFC9052#section-3">COSE Header</a>,
                a <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifier</a> can use this parameter
                as a hint indicating which key was used to secure the [=verifiable credential=], when performing a
                <a data-cite="VC-DATA-MODEL-2.0#dfn-verify">verification</a> process as defined in <a
                    data-cite="RFC7515#section-4.1.4">RFC7515</a>.
            </p>
            <p>
                <code>kid</code> MUST be present when the key of the <a
                    data-cite="VC-DATA-MODEL-2.0#dfn-issuers">issuer</a>
                or <a data-cite="VC-DATA-MODEL-2.0#dfn-subjects">subject</a> is expressed as a DID URL.
            </p>
        </section>
        <section>
            <h2 id="iss">iss</h2>
            <p>
                If <code>iss</code> is present in the <a data-cite="RFC7515#section-4.1">JOSE Header</a>,
                the <a data-cite="RFC7519#section-4.1.1">JWT Claims</a>,
                or the <a data-cite="RFC9052#section-3">COSE Header</a>,
                a <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifier</a> can use this parameter
                to obtain a <a data-cite="RFC7517#section-4">JSON Web Key</a> to use in the
                <a data-cite="VC-DATA-MODEL-2.0#dfn-verify">verification</a> process.
            </p>
            <p>
                The value of the <a data-cite="VC-DATA-MODEL-2.0#issuer">issuer</a> property can be either a string or
                an object.
                When <code>issuer</code> value is a string, <code>iss</code> value, if present, MUST match
                <code>issuer</code> value.
                When <code>issuer</code> value is an object with an <code>id</code> value,
                <code>iss</code> value, if present, MUST match <code>issuer.id</code> value.
            </p>
            <p>
                If <code>kid</code> is also present in the
                <a data-cite="RFC7515#section-4.1">JOSE Header</a>, it is used to
                distinguish the specific key used.
            </p>
        </section>

        <section>
            <h2 id="cnf">cnf</h2>
            <p>
                If <code>cnf</code> is present in the <a data-cite="RFC7515#section-4.1">JOSE Header</a>,
                the <a data-cite="RFC7519#section-4.1.1">JWT Claims</a>,
                or the <a data-cite="RFC9052#section-3">COSE Header</a>,
                a <a data-cite="VC-DATA-MODEL-2.0#dfn-verifier">verifier</a> MAY use this parameter
                to identify a proof-of-possession key in the manner described in [[RFC7800]]
                or [[RFC8747]] for use in the
                <a data-cite="VC-DATA-MODEL-2.0#dfn-verify">verification</a> process.
            </p>
            <p>
                Use of a proof-of-possession key provided by the [=Holder=] to the [=Issuer=]
                to establish a cryptographic binding to the [=Holder=] in the [=Verifiable Credential=]
                that is verifiable by the [=Verifier=] in the [=Verifiable Presentation=] is RECOMMENDED.
            </p>
        </section>
    </section>

    <section>
        <h2 id="well-known-uris">Well-Known URIs</h2>

        <section>
            <h3 id="jwt-issuer">JWT Issuer</h3>
        <p>
            When the [=issuer=] value is a URL using the HTTPS scheme,
            [=issuer=] metadata including the [=issuer=]'s [=public keys=] can be retrieved using the mechanism
            defined in [[SD-JWT-VC]].
        </p>

        <p class="issue" title="(AT RISK) Feature depends on demonstration of independent implementations">
            This normative statement depends on the IETF OAuth working group draft [[SD-JWT-VC]].
            This feature is at risk and will be removed from the specification if at least
            two independent, interoperable implementations are not demonstrated.
        </p>

        <pre class="example" title="A kid as a URL with a JWK Thumbprint URI">
        {
          "alg": "EdDSA",
          "kid": "https://vendor.example/issuers/42/keys/urn:ietf:params:oauth:jwk-thumbprint:sha-256:NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs"
        }
        </pre>
        </section>
    </section>

    <section>
    <h3 id="using-controller-documents">Using Controller Documents</h3>
	<p>
	  When using [=controller documents=] with this specification,
	  the following requirements apply.
	</p>
	<p>
	  The value of the `type` property of the verification method MUST be <code>JsonWebKey</code>.
    </p>
    <p>
        Verification material MUST be expressed in the <code>publicKeyJwk</code> property
        of a <code>JsonWebKey</code>. This key material is retrieved based on hints in the
        JOSE or COSE message envelopes, such as <code>kid</code> or <code>iss</code>. At
        the time of writing, there is no standard way to retrieve a public key in JWK format
        from a DID URL or [=controller document=].
    </p>
       <!-- REGULAR URLS via "issuer" and "holder" -->
    <p>
        When <a href="#iss">iss</a> is absent, and the <a data-cite="VC-DATA-MODEL-2.0#dfn-issuers">issuer</a> is
        identified as a [[URL]],
        the <a href="#kid">kid</a> MUST be an absolute [[URL]] to a
        verification method listed in a [=controller document=] or
        a <a data-cite="DID-CORE#dfn-did-documents">DID Document</a>.
    </p>

    <p>
        When using [[URL]] identifiers, the <code>kid</code> is RECOMMENDED to be
        an absolute [[URL]] that includes a JWK Thumbprint URI
        as defined in [[RFC7638]]. For example:
        <code>https://vendor.example/issuers/42/keys/urn:ietf:params:oauth:jwk-thumbprint:sha-256:NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs</code>
    </p>

    <pre class="example" title="An issuer identified by a controller document identifier">
{
  "issuer": {
    "id": "https://university.example/issuers/565049"
  }
  // ...
}
</pre>
    <pre class="example" title="A kid as a controller document verification method identifier">
{
  "alg": "ES384",
  "kid": "https://university.example/issuers/565049#key-123
}
</pre>

    <p>
        When the <a data-cite="VC-DATA-MODEL-2.0#dfn-holders">holder</a> is
        identified as a [[URL]],
        and <a href="#iss">iss</a> is absent,
        the <a href="#kid">kid</a> MUST be an absolute [[URL]] to a
        verification method listed in a [=controller document=].
    </p>
    <pre class="example" title="A holder identified by a controller document identifier">
{
  "holder": {
    "id": "https://university.example/issuers/565049"
  }
  // ...
}
</pre>
    <pre class="example" title="A kid as a controller document verification method identifier">
{
  "alg": "ES384",
  "kid": "https://university.example/issuers/565049#key-123
}
</pre>
    </section>
</section>

<section>
    <h2 id="algorithms">Algorithms</h2>
    <p>
        This specification might be used with many different key discovery protocols.
        Therefore, discovery of verification keys is described in <a href="#key_discovery"></a>,
        and is assumed to have succeeded prior to beginning the verification process.
    </p>
    <p>
        As a general rule, verifiers SHOULD strive to minimize the processing of
        untrusted data. This includes minimizing any processing of the protected header,
        unprotected header, or payload as part of the key discovery procedures.
    </p>
    <p>
        After verification has succeeded, additional validation checks SHOULD be
        performed as described in Section <a href="#validation-algorithm"></a>
    </p>
    <p>
        The outputs for the following algorithms are:
    </p>
    <ul>
        <li>
            <code>status</code>: a boolean indicating the result of verification,
            <code>true</code> for success and <code>false</code> for failure.
        </li>
        <li>
            <code>document</code>: a document conforming to the [[[VC-DATA-MODEL-2.0]]] [[VC-DATA-MODEL-2.0]]
        </li>
        <li>
            <code>mediaType</code>: <code>vc</code> or <code>vp</code>
        </li>
    </ul>
    <section>
        <h3 id="alg-jose">Verifying a Credential or Presentation Secured with JOSE</h3>
        <p>
            The inputs for this algorithm are:
        </p>
        <ul>
            <li>
                <code>inputMediaType</code>: <code>vc-ld+jwt</code> or
                <code>vp-ld+jwt</code>
            </li>
            <li>
                <code>inputDocument</code>: the verifiable credential secured as a JWT [[RFC7519]]
            </li>
        </ul>
        <p>
            Upon receipt of the verifiable credential or presentation secured as a JWT
            [[RFC7519]], the holder or verifier follows this algorithm:
        </p>
        <ol>
            <li>
                Follow the algorithm defined in <a data-cite="RFC7519#section-7.2"> Validating a JWT</a> [[RFC7519]].
            </li>
            <li>
                If processing completes successfully:
                <ol>
                    <li>
                        Set <code>status</code> to <code>true</code>
                    </li>
                    <li>
                        Set <code>mediaType</code> to <code>vc</code> or <code>vp</code>
                    </li>
                    <li>
                        Set <code>document</code> to the decoded JWS payload.
                    </li>
                    <li>
                        Return
                    </li>
                </ol>
            </li>
            <li>
                If processing aborts for any reason or the JWT is rejected:
                <ol>
                    <li>
                        Set <code>status</code> to <code>false</code>
                    </li>
                    <li>
                        Set <code>document</code> to <code>null</code>
                    </li>
                    <li>
                        Set <code>mediaType</code> to <code>null</code>
                    </li>
                    <li>
                        Return
                    </li>
                </ol>
            </li>
        </ol>
    </section>
    <section>
        <h3 id="alg-sd-jwt">Verifying a Credential or Presentation Secured with SD-JWT</h3>
        <p>
            The inputs for this algorithm are:
        </p>
        <ul>
            <li>
                <code>inputMediaType</code>: <code>vc-ld+sd-jwt</code>
            </li>
            <li>
                <code>inputDocument</code>: the verifiable credential secured with [[SD-JWT]]
            </li>
        </ul>
        <p>
            Upon receipt of the verifiable credential or presentation secured with
            [[SD-JWT]], the holder or verifier follows this algorithm:
        </p>
        <ol>
            <li>
                Follow the algorithms defined in <a data-cite="SD-JWT#section-8">SD-JWT</a> for
                verification of the SD-JWT.
            </li>
            <li>
                If processing completes successfully:
                <ol>
                    <li>
                        Set <code>status</code> to <code>true</code>
                    </li>
                    <li>
                        Set <code>mediaType</code> to <code>vc</code>
                    </li>
                    <li>
                        Convert the SD-JWT payload back into the JSON claim set by reversing the process
                        in [[[SD-JWT]]] [[SD-JWT]]. Set <code>document</code> to the JSON claim set.
                        (For examples of the transition from JSON claim set to SD-JWT payload, please
                        see <a data-cite="SD-JWT#appendix-A">SD-JWT examples</a>).
                    </li>
                    <li>
                        Return
                    </li>
                </ol>
            </li>
            <li>
                If processing aborts for any reason or the SD-JWT is rejected:
                <ol>
                    <li>
                        Set <code>status</code> to <code>false</code>
                    </li>
                    <li>
                        Set <code>document</code> to <code>null</code>
                    </li>
                    <li>
                        Set <code>mediaType</code> to <code>null</code>
                    </li>
                    <li>
                        Return
                    </li>
                </ol>
            </li>
        </ol>
    </section>
    <section>
        <h3 id="alg-cose">Verifying a Credential or Presentation Secured with COSE</h3>
        <p>
            The inputs for this algorithm are:
        </p>
        <ul>
            <li>
                <code>inputMediaType</code>: <code>vc-ld+cose</code> or
                <code>vp-ld+cose</code>
            </li>
            <li>
                <code>inputDocument</code>: the verifiable credential or verifiable presentation
                secured with [[[RFC9052]]]
            </li>
        </ul>
        <p>
            Upon receipt of the verifiable credential or presentation secured with
            [[RFC9052]], the holder or verifier follows this algorithm:
        </p>
        <ol>
            <li>
                Follow the algorithm defined in [[[RFC9052]]] [[RFC9052]] under the Signing and
                Verification Process for COSE_Sign1.
            </li>
            <li>
                If processing completes successfully:
                <ol>
                    <li>
                        Set <code>status</code> to <code>true</code>
                    </li>
                    <li>
                        Set <code>mediaType</code> to <code>vc</code> or <code>vp</code>
                    </li>
                    <li>
                        Set <code>document</code> to the decoded COSE_Sign1 payload.
                    </li>
                    <li>
                        Return
                    </li>
                </ol>
            </li>
            <li>
                If processing aborts for any reason:
                <ol>
                    <li>
                        Set <code>status</code> to <code>false</code>
                    </li>
                    <li>
                        Set <code>document</code> to <code>null</code>
                    </li>
                    <li>
                        Set <code>mediaType</code> to <code>null</code>
                    </li>
                    <li>
                        Return
                    </li>
                </ol>
            </li>
        </ol>
    </section>

    <h3 id="validation-algorithm">Validation</h3>

    <p>
        All claims expected for the <code>typ</code> MUST be present.
        All claims that are understood MUST be evaluated according the verifier's validation policies.
        All claims that are not understood MUST be ignored.
    </p>

    <p>
        The verified <code>document</code> returned from verification MUST be a
        well-formed compact JSON-LD document, as described in
        <a data-cite="VC-DATA-MODEL-2.0/#conformance">Verifiable Credentials Data Model v2.0</a>.
    </p>

    <p>
        Schema extension mechanisms such as <code>credentialSchema</code> SHOULD be checked.
        If the extension mechanism <code>type</code> is not understood, this property
        MUST be ignored.
    </p>

    <p>
        Status extension mechanisms such as <code>credentialStatus</code> SHOULD be checked.
        If the extension mechanism <code>type</code> is not understood, this property
        MUST be ignored.
    </p>

    <p>
        Based on the validation policy of the verifier, the type of credentials, and
        the type of securing mechanism, additional validation checks MAY be applied.
        For example, dependencies between multiple credentials, ordering or timing
        information associated with multiple credentials, and/or multiple presentations
        could cause an otherwise valid credential or presentation to be considered
        invalid.
    </p>

</section>

<section class="informative">
    <h2 id="iana-considerations">IANA Considerations</h2>

    <section>
        <h2 id="media-types">Media Types</h2>

        <section id="vc-ld-jwt-media-type">
            <h2 id="vcc-ld-json-jwt"><code>application/vc-ld+jwt</code></h2>
            <p>
                This specification registers the
                <code>application/vc-ld+jwt</code> Media Type specifically for
                identifying a <a data-cite="JWT"></a>
                with a payload
                conforming to the <a data-cite="VC-DATA-MODEL-2.0#verifiable-credentials">
                Verifiable Credential Data Model</a>.
            </p>
            <table>
                <tr>
                    <td>Type name:</td>
                    <td>`application`</td>
                </tr>
                <tr>
                    <td>Subtype name:</td>
                    <td>`vc-ld+jwt`</td>
                </tr>
                <tr>
                    <td>Required parameters:</td>
                    <td>None</td>
                </tr>
                <tr>
                    <td>Encoding considerations:</td>
                    <td>
                        binary; `application/jwt` values are a series of base64url-encoded values
                        (some of which may be the empty string) separated by period ('.').
                    </td>
                </tr>
                <tr>
                    <td>Security considerations:</td>
                    <td>
                        <p>As defined in this specification. See also the security
                            considerations in <a data-cite="JWT"></a>.</p>
                    </td>
                </tr>
                <tr>
                    <td>Contact:</td>
                    <td>
                        W3C Verifiable Credentials Working Group <a
                            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
                    </td>
                </tr>
            </table>
        </section>

        <section id="vp-ld-jwt-media-type">
            <h2 id="vp-ld-json-jwt"><code>application/vp-ld+jwt</code></h2>
            <p>
                This specification registers the
                <code>application/vp-ld+jwt</code> Media Type specifically for
                identifying a <a data-cite="JWT"></a>
                with a payload
                conforming to the <a data-cite="VC-DATA-MODEL-2.0#verifiable-presentations">
                Verifiable Presentations definition in the Verifiable Credential Data Model</a>.
            </p>
            <table>
                <tr>
                    <td>Type name:</td>
                    <td>application</td>
                </tr>
                <tr>
                    <td>Subtype name:</td>
                    <td>vp-ld+jwt</td>
                </tr>
                <tr>
                    <td>Required parameters:</td>
                    <td>None</td>
                </tr>
                <tr>
                    <td>Encoding considerations:</td>
                    <td>
                        binary; `application/jwt` values are a series of base64url-encoded values
                        (some of which may be the empty string) separated by period ('.').
                    </td>
                </tr>
                <tr>
                    <td>Security considerations:</td>
                    <td>
                        <p>As defined in this specification. See also the security
                            considerations in <a data-cite="JWT"></a>.</p>
                    </td>
                </tr>
                <tr>
                    <td>Contact:</td>
                    <td>
                        W3C Verifiable Credentials Working Group <a
                            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
                    </td>
                </tr>
            </table>
        </section>

        <section id="vc-ld-sd-jwt-media-type">
            <h2 id="vc-ld-json-sd-jwt"><code>application/vc-ld+sd-jwt</code></h2>
            <p>
                This specification registers the
                <code>application/vc-ld+sd-jwt</code> Media Type specifically for
                identifying a <a data-cite="SD-JWT"></a>
                with a payload
                conforming to the <a data-cite="VC-DATA-MODEL-2.0#verifiable-credentials">
                Verifiable Credential Data Model</a>.
            </p>
            <table>
                <tr>
                    <td>Type name:</td>
                    <td>`application`</td>
                </tr>
                <tr>
                    <td>Subtype name:</td>
                    <td>`vc-ld+sd-jwt`</td>
                </tr>
                <tr>
                    <td>Required parameters:</td>
                    <td>None</td>
                </tr>
                <tr>
                    <td>Encoding considerations:</td>
                    <td>
                        binary; `application/sd-jwt` values are a series of base64url-encoded values
                        (some of which may be the empty string) separated by period ('.') or tilde ('~') characters.
                    </td>
                </tr>
                <tr>
                    <td>Security considerations:</td>
                    <td>
                        <p>As defined in this specification. See also the security
                            considerations in <a data-cite="SD-JWT"></a>.</p>
                    </td>
                </tr>
                <tr>
                    <td>Contact:</td>
                    <td>
                        W3C Verifiable Credentials Working Group <a
                            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
                    </td>
                </tr>
            </table>
        </section>

        <section id="vp-ld-sd-jwt-media-type">
            <h2 id="vp-ld-json-sd-jwt"><code>application/vp-ld+sd-jwt</code></h2>
            <p>
                This specification registers the
                <code>application/vp-ld+sd-jwt</code> Media Type specifically for
                identifying a <a data-cite="SD-JWT"></a>
                with a payload
                conforming to the <a data-cite="VC-DATA-MODEL-2.0#verifiable-presentations">
                Verifiable Presentations definition in the Verifiable Credential Data Model</a>.
            </p>
            <table>
                <tr>
                    <td>Type name:</td>
                    <td>application</td>
                </tr>
                <tr>
                    <td>Subtype name:</td>
                    <td>vp-ld+sd-jwt</td>
                </tr>
                <tr>
                    <td>Required parameters:</td>
                    <td>None</td>
                </tr>
                <tr>
                    <td>Encoding considerations:</td>
                    <td>
                        binary; `application/sd-jwt` values are a series of base64url-encoded values
                        (some of which may be the empty string) separated by period ('.') or tilde ('~') characters.
                    </td>
                </tr>
                <tr>
                    <td>Security considerations:</td>
                    <td>
                        <p>As defined in this specification. See also the security
                            considerations in <a data-cite="SD-JWT"></a>.</p>
                    </td>
                </tr>
                <tr>
                    <td>Contact:</td>
                    <td>
                        W3C Verifiable Credentials Working Group <a
                            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
                    </td>
                </tr>
            </table>
        </section>

        <section id="vc-ld-json-cose-media-type">
            <h2 id="vc-ld-json-cose"><code>application/vc-ld+cose</code></h2>
            <p>
                This specification registers the
                <code>application/vc-ld+cose</code> Media Type specifically for
                identifying a COSE object [[RFC9052]]
                with a payload
                conforming to the <a data-cite="VC-DATA-MODEL-2.0#verifiable-credentials">
                Verifiable Credential Data Model</a>.
            </p>
            <table>
                <tr>
                    <td>Type name:</td>
                    <td>`application`</td>
                </tr>
                <tr>
                    <td>Subtype name:</td>
                    <td>`vc-ld+cose`</td>
                </tr>
                <tr>
                    <td>Required parameters:</td>
                    <td>None</td>
                </tr>
                <tr>
                    <td>Encoding considerations:</td>
                    <td>
                        binary (CBOR)
                    </td>
                </tr>
                <tr>
                    <td>Security considerations:</td>
                    <td>
                        <p>As defined in this specification. See also the security
                            considerations in [[RFC9052]].</p>
                    </td>
                </tr>
                <tr>
                    <td>Contact:</td>
                    <td>
                        W3C Verifiable Credentials Working Group <a
                            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
                    </td>
                </tr>
            </table>
        </section>

        <section id="vp-ld-json-cose-media-type">
            <h2 id="vp-ld-json-cose"><code>application/vp-ld+cose</code></h2>
            <p>
                This specification registers the
                <code>application/vp-ld+cose</code> Media Type specifically for
                identifying a COSE object [[RFC9052]]
                with a payload
                conforming to the <a data-cite="VC-DATA-MODEL-2.0#verifiable-presentations">
                Verifiable Presentations definition in the Verifiable Credential Data Model</a>.
            </p>
            <table>
                <tr>
                    <td>Type name:</td>
                    <td>`application`</td>
                </tr>
                <tr>
                    <td>Subtype name:</td>
                    <td>`vp-ld+cose`</td>
                </tr>
                <tr>
                    <td>Required parameters:</td>
                    <td>None</td>
                </tr>
                <tr>
                    <td>Encoding considerations:</td>
                    <td>
                        binary (CBOR)
                    </td>
                </tr>
                <tr>
                    <td>Security considerations:</td>
                    <td>
                        <p>As defined in this specification. See also the security
                            considerations in [[RFC9052]].</p>
                    </td>
                </tr>
                <tr>
                    <td>Contact:</td>
                    <td>
                        W3C Verifiable Credentials Working Group <a
                            href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
                    </td>
                </tr>
            </table>
        </section>
    </section>

</section>
<section class="informative">
    <h3 id="other-considerations">Other Considerations</h3>

    <section>
        <h2 id="privacy-considerations">Privacy Considerations</h2>
        <p>
            Verifiable Credentials often contain sensitive information that
            needs to be protected to ensure the privacy and security of
            organizations and individuals. This section outlines some
            privacy considerations relevant to implementers and users.
        </p>
        <p>
            Implementers are advised to note and abide by all privacy
            considerations called out in [[VC-DATA-MODEL-2.0]].
        </p>
        <p>
            Implementers are additionally advised to reference the
            <a href="https://www.rfc-editor.org/rfc/rfc7519#section-12">Privacy
                Consideration</a>
            section of the JWT specification
	    and NIST Special Publication 800-122 [[SP-800-122]
	    "Guide to Protecting the Confidentiality of Personally Identifiable Information (PII)"
	    for privacy guidance.
        </p>
        <p>
            In addition to the privacy recommendations in the
            [[VC-DATA-MODEL-2.0]], the following considerations are given:
        <ul>
            <li>
                <p>
                    Minimization of data: It is considered best practice for
                    Verifiable Credentials to only contain the minimum amount of
                    data necessary to achieve their intended purpose. This helps
                    to limit the amount of sensitive information that is shared
                    or stored unnecessarily.
                </p>
            </li>
            <li>
                <p>
                    Informed consent: It is considered best practice that
                    individuals be fully informed about how their data will be
                    used and provide the ability to consent to or decline the
                    use of their data. This helps to ensure that individuals
                    maintain control over their own personal information.
                </p>
            </li>
            <li>
                <p>
                    Data protection: It is considered best practice to protect
                    Verifiable Credentials using strong encryption and other
                    security measures to prevent unauthorized access,
                    modification, or disclosure.
                </p>
            </li>
        </ul>
        <p>
            These considerations are not exhaustive, and implementers and
            users are advised to consult additional privacy resources and
            best practices to ensure the privacy and security of Verifiable
            Credentials implemented using this specification.
        </p>
    </section>

    <section>
        <h2 id="security-considerations">Security Considerations</h2>
        <p>
            This section outlines security considerations for implementers
            and users of this specification. It is important to carefully
            consider these factors to ensure the security and integrity of
            Verifiable Credentials when implemented using JOSE or COSE.
        </p>
        <p>
            When implementing this specification, it is essential to address all
            security issues relevant to broad cryptographic applications.
            This especially includes protecting the user's asymmetric
            private and symmetric secret keys, as well as employing
            countermeasures against various attacks. Failure to adequately
            address these issues could compromise the security and integrity
            of Verifiable Credentials, potentially leading to unauthorized
            access, modification, or disclosure of sensitive information.
        </p>
        <p>
            Implementers are advised to follow best practices and
            established cryptographic standards to ensure the secure
            handling of keys and other sensitive data. Additionally, conduct
            regular security assessments and audits to identify and address
            any vulnerabilities or threats.
        </p>
        <p>
            Follow all security considerations outlined in [[RFC7515]] and
            [[RFC7519]].
        </p>
        <p>
            When utilizing JSON-LD, take special care around remote
            retrieval of contexts and follow the additional security
            considerations noted in [[json-ld11]].
        </p>
        <p>
            As noted in [[RFC7515]] when utilizing JSON [[RFC7159]], strict
            validation is a security requirement. If malformed JSON is
            received, it may be impossible to reliably interpret the
            producer's intent, potentially leading to ambiguous or
            exploitable situations. To prevent these risks, it is essential
            to use a JSON parser that strictly validates the syntax of all
            input data. It is essential that any JSON inputs that do not
            conform to the JSON-text syntax defined in [[RFC7159]] be
            rejected in their entirety by JSON parsers. Failure to reject
            invalid input could compromise the security and integrity of
            Verifiable Credentials.
        </p>
    </section>

    <section>
        <h2 id="accessibility">Accessibility</h2>
        <p>
            When implementing this specification, it is crucial for
            technical implementers to consider various accessibility
            factors. Ignoring accessibility concerns renders the information
            unusable for a significant portion of the population. To ensure
            equal access for all individuals, regardless of their abilities,
            it is vital to adhere to accessibility guidelines and standards,
            such as the Web Content Accessibility Guidelines (WCAG 2.1)
            [[WCAG21]]. This becomes even more critical when establishing
            systems that involve cryptography, as they have historically
            posed challenges for assistive technologies.
        </p>
        <p>
            Implementers are advised to note and abide by all accessibility
            considerations called out in [[VC-DATA-MODEL-2.0]].
        </p>
    </section>
</section>


<section class="informative">
    <h3 id="examples">Examples</h3>
    <section>
        <h2 id="controllers">Controllers</h2>

        <pre class="example" title="A minimal controller document">
        {
          "id": "https://vendor.example",
        }
      </pre>

        <pre class="example" title="A controller document with verification method">
        {
          "id": "https://university.example/issuers/565049",
          "verificationMethod": [{
            "id": "https://university.example/issuers/565049#key-123",
            "type": "JsonWebKey",
            "controller": "https://university.example/issuers/565049",
            "publicKeyJwk": {
              "kty": "EC",
              "crv": "P-384",
              "alg": "ES384",
              "x": "PxgAmVYOQvSNcMYL2tOzoLwSWn4Ta3tIMPEUKR8pxeb-gmR11-DyKHBoIiY-2LhM",
              "y": "BZEBTkImVdpwvxR9THIRw16eblnj5-tZa7m-ww5uVd4kyPJNRoWUn2aT9ZuarAe-"
            }
          }]
        }
      </pre>

        <pre class="example" title="A controller document with verification relationships">
        {
          "id": "https://university.example/issuers/565049",
          "verificationMethod": [{
            "id": "https://university.example/issuers/565049#key-123",
            "type": "JsonWebKey",
            "controller": "https://university.example/issuers/565049",
            "publicKeyJwk": {
              "kty": "EC",
              "crv": "P-384",
              "alg": "ES384",
              "x": "PxgAmVYOQvSNcMYL2tOzoLwSWn4Ta3tIMPEUKR8pxeb-gmR11-DyKHBoIiY-2LhM",
              "y": "BZEBTkImVdpwvxR9THIRw16eblnj5-tZa7m-ww5uVd4kyPJNRoWUn2aT9ZuarAe-"
            }
          }],
          "authentication": ["https://university.example/issuers/565049#key-123"],
          "assertionMethod": ["https://university.example/issuers/565049#key-123"]
        }
      </pre>

        <pre class="example" title="A verifiable credential controller document">
{
  "@context": [
        "https://www.w3.org/ns/did/v1",
        "https://w3id.org/security/jwk/v1",
        {
            "@vocab": "https://vendor.example#"
        }
  ],
  "id": "did:web:vendor.example",
  "alsoKnownAs": ["https://vendor.example",
    "did:jwk:eyJraWQiOiJ1cm46aWV0ZjpwYXJhbXM6b2F1dGg6andrLXRodW1icHJpbnQ6c2hhLTI1NjpGZk1iek9qTW1RNGVmVDZrdndUSUpqZWxUcWpsMHhqRUlXUTJxb2JzUk1NIiwia3R5IjoiT0tQIiwiY3J2IjoiRWQyNTUxOSIsImFsZyI6IkVkRFNBIiwieCI6IkFOUmpIX3p4Y0tCeHNqUlBVdHpSYnA3RlNWTEtKWFE5QVBYOU1QMWo3azQifQ"
  ],
  "verificationMethod": [{
    "id": "#urn:ietf:params:oauth:jwk-thumbprint:sha-256:NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs",
    "type": "JsonWebKey",
    "controller": "did:web:vendor.example",
    "publicKeyJwk": {
      "kty": "EC",
      "crv": "P-521",
      "alg": "ES512",
      "x": "AFTyMw-fIYJNg6fBVJvOPOsLxmnNj8HgqMChyRL0swLaefVAc7wrWZ8okQJqMmvv03JRUp277meQZM3JcvXFkH1v",
      "y": "ALn96CrD88b4TClmkl1sk0xk2FgAIda97ZF8TUOjbeWSzbKnN2KB6pqlpbuJ2xIRXvsn5BWQVlAT2JGpGwDNMyV1"
    }
  }, {
    "id": "#z6MkhEdpG12jyQegrr62ACRmNY8gc531W2j9Xo39cHphuCEH",
    "type": "JsonWebKey2020",
    "controller": "https://vendor.example",
    "publicKeyJwk": {
      "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:FfMbzOjMmQ4efT6kvwTIJjelTqjl0xjEIWQ2qobsRMM",
      "kty": "OKP",
      "crv": "Ed25519",
      "alg": "EdDSA",
      "x": "ANRjH_zxcKBxsjRPUtzRbp7FSVLKJXQ9APX9MP1j7k4"
    }
  }, {
    "id": "#subject-authentication",
    "type": "JsonWebKey",
    "controller": "did:web:vendor.example",
    "publicKeyJwk": {
      "kty": "EC",
      "crv": "P-384",
      "alg": "ES384",
      "x": "PxgAmVYOQvSNcMYL2tOzoLwSWn4Ta3tIMPEUKR8pxeb-gmR11-DyKHBoIiY-2LhM",
      "y": "BZEBTkImVdpwvxR9THIRw16eblnj5-tZa7m-ww5uVd4kyPJNRoWUn2aT9ZuarAe-"
    }
  }, {
    "id": "#credential-issuance",
    "type": "JsonWebKey",
    "controller": "did:web:vendor.example",
    "publicKeyJwk": {
      "kty": "EC",
      "crv": "P-256",
      "alg": "ES256",
      "x": "MYvnaI87pfrn3FpTqW-yNiFcF1K7fedJiqapm20_q7c",
      "y": "9YEbT6Tyuc7xp9yRvhOUVKK_NIHkn5HpK9ZMgvK5pVw"
    }
  }, {
    "id": "#key-agreement",
    "type": "JsonWebKey",
    "controller": "did:web:vendor.example",
    "publicKeyJwk": {
      "kty": "OKP",
      "crv": "X25519",
      "alg": "ECDH-ES+A128KW",
      "x": "qLZkSTbstvMWPTivmiQglEFWG2Ff7gNDVoVisdZTr1I"
    }
  }],
  "authentication": ["#subject-authentication"],
  "assertionMethod": ["#credential-issuance"]
}
      </pre>

    </section>
    <section>
        <h3 id="credentials">Credentials</h3>
        <pre class="example nohighlight vc" data-vc-tabs="jose sd-jwt cose" title="A revocable credential with multiple subjects">
{
  "@context": ["https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://contoso.example/credentials/23894672394",
  "type": ["VerifiableCredential", "K9UnitCredential"],
  "issuer": {
    "id": "https://contoso.example"
  },
  "validFrom": "2015-04-16T05:11:32.432Z",
  "credentialStatus": {
    "id": "https://contoso.example/credentials/status/4#273762",
    "type": "StatusList2021Entry",
    "statusPurpose": "revocation",
    "statusListIndex": "273762",
    "statusListCredential": "https://contoso.example/credentials/status/4"
  },
  "credentialSubject": [{
    "id": "did:example:1312387641",
    "type": "Person"
  }, {
    "id": "did:example:63888231",
    "type": "Dog"
  }]
}
      </pre>

        <pre class="example nohighlight vc" data-vc-tabs="jose sd-jwt cose" title="A credential with a schema">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://contoso.example/credentials/35327255",
  "type": ["VerifiableCredential", "KYCExample"],
  "issuer": "did:web:contoso.example",
  "validFrom": "2019-05-25T03:10:16.992Z",
  "validUntil": "2027-05-25T03:10:16.992Z",
  "credentialSchema": {
    "id": "https://contoso.example/bafybeigdyr...lqabf3oclgtqy55fbzdi",
    "type": "JsonSchema"
  },
  "credentialSubject": {
    "id": "did:example:1231588",
    "type": "Person"
  }
}
      </pre>
    </section>

    <section>
        <h2 id="presentations">Presentations</h2>

        <pre class="example nohighlight vc" data-vc-tabs="jose sd-jwt cose" title="Presentation">
{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "type": "VerifiablePresentation",
  "verifiableCredential": [
    {
      "@context": "https://www.w3.org/ns/credentials/v2",
      "id": "data:application/vc-ld+cose,QzVjV...RMjU",
      "type": "EnvelopedVerifiableCredential"
    },
    {
      "@context": "https://www.w3.org/ns/credentials/v2",
      "id": "data:application/vc-ld+jwt,eyVjV...RMjU",
      "type": "EnvelopedVerifiableCredential"
    },
    {
      "@context": "https://www.w3.org/ns/credentials/v2",
      "id": "data:application/vc-ld+sd-jwt,eyVjV...RMjU~",
      "type": "EnvelopedVerifiableCredential"
    }
  ]
}
      </pre>

    </section>

    <section>
        <h3 id="date-uris">Data URIs</h3>
        <pre class="example" title="A simple URI-encoded Verifiable Credential">
data:application/vc-ld+sd-jwt,eyJhbGciOiJFUzM4NCIsImtpZCI6IlNJM1JITm91aDhvODFOT09OUFFVQUw3RWdaLWtJNl94ajlvUkV2WDF4T3ciLCJ0eXAiOiJ2YytsZCtqc29uK3NkLWp3dCIsImN0eSI6InZjK2xkK2pzb24ifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiaXNzdWVyIjoiaHR0cHM6Ly91bml2ZXJzaXR5LmV4YW1wbGUvaXNzdWVycy81NjUwNDkiLCJ2YWxpZEZyb20iOiIyMDEwLTAxLTAxVDE5OjIzOjI0WiIsImNyZWRlbnRpYWxTY2hlbWEiOnsiX3NkIjpbIkU3dU1sSWFyS29iYXJTdEZGRjctZm5qaV9sQVdnM3BGMkV5dVc4dWFYakUiLCJYelRaSVgyNGdDSWxSQVFHclFoNU5FRm1XWkQtZ3Z3dkIybzB5Y0FwNFZzIl19LCJjcmVkZW50aWFsU3ViamVjdCI6eyJkZWdyZWUiOnsibmFtZSI6IkJhY2hlbG9yIG9mIFNjaWVuY2UgYW5kIEFydHMiLCJfc2QiOlsiT3oxUEZIMG0tWk9TdEhwUVZyeGlmVlpKRzhvNmlQQmNnLVZ2SXQwd2plcyJdfSwiX3NkIjpbIkVZQ1daMTZZMHB5X1VNNzRHU3NVYU9zT19mdDExTlVSaFFUTS1TT1lFTVEiXX0sIl9zZCI6WyJqT055NnZUbGNvVlAzM25oSTdERGN3ekVka3d2R3VVRXlLUjdrWEVLd3VVIiwid21BdHpwc0dRbDJveS1PY2JrSEVZcE8xb3BoX3VYcWVWVTRKekF0aFFibyJdLCJfc2RfYWxnIjoic2hhLTI1NiIsImlzcyI6Imh0dHBzOi8vdW5pdmVyc2l0eS5leGFtcGxlL2lzc3VlcnMvNTY1MDQ5IiwiaWF0IjoxNjk3Mjg5OTk2LCJleHAiOjE3Mjg5MTIzOTYsImNuZiI6eyJqd2siOnsia3R5IjoiRUMiLCJjcnYiOiJQLTM4NCIsImFsZyI6IkVTMzg0IiwieCI6InZFdV84WGxZT0ZFU2hTcVRpZ2JSYWduZ0ZGM1p5U0xrclNHekh3azFBT1loanhlazVhV21HY2UwZU05S0pWOEIiLCJ5IjoiRUpNY2czWXBzUTB3M2RLNHlVa25QczE1Z0lsY2Yyay03dzFKLTNlYlBiOERENmQtUkhBeGUwMDkzSWpfdTRCOSJ9fX0.rYzbxb6j1dwop8_s491iArVVJNm6A6C3b742gOm_qYO3zdkyQU4_VxxOSJ8ECcmWj2r5KyiCNC1ojfO4Yms-zBsjt7PoMYpYWBplsqXpiIvnehmM7D0eOLi40uHXki0X~WyJSWTg1YTZNMmEwX3VDWlFTVGZmTFdRIiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~WyJMeG5GYTBXVm8wRUluVy1QdS1fd1dRIiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyJUQVdrakpCaVpxdC1rVU54X1EweUJBIiwgImlkIiwgImh0dHBzOi8vZXhhbXBsZS5vcmcvZXhhbXBsZXMvZGVncmVlLmpzb24iXQ~WyJTd2xuZFpPZzZEZ1ZERFp5X0RvYVFBIiwgInR5cGUiLCAiSnNvblNjaGVtYSJd~WyJuSnJlU3E1Nzg3RGZMSDJCbU03cXFRIiwgImlkIiwgImRpZDpleGFtcGxlOjEyMyJd~WyIxMjNNd3hNcHRiek02YUk2aW03ME1RIiwgInR5cGUiLCAiQmFjaGVsb3JEZWdyZWUiXQ~
      </pre>

        <pre class="example" title="A simple URI-encoded Verifiable Presentation">
data:application/vp-ld+sd-jwt,eyJhbGciOiJFUzM4NCIsImtpZCI6IlNJM1JITm91aDhvODFOT09OUFFVQUw3RWdaLWtJNl94ajlvUkV2WDF4T3ciLCJ0eXAiOiJ2YytsZCtqc29uK3NkLWp3dCIsImN0eSI6InZjK2xkK2pzb24ifQ.eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiaXNzdWVyIjoiaHR0cHM6Ly91bml2ZXJzaXR5LmV4YW1wbGUvaXNzdWVycy81NjUwNDkiLCJ2YWxpZEZyb20iOiIyMDEwLTAxLTAxVDE5OjIzOjI0WiIsImNyZWRlbnRpYWxTY2hlbWEiOnsiX3NkIjpbIkU3dU1sSWFyS29iYXJTdEZGRjctZm5qaV9sQVdnM3BGMkV5dVc4dWFYakUiLCJYelRaSVgyNGdDSWxSQVFHclFoNU5FRm1XWkQtZ3Z3dkIybzB5Y0FwNFZzIl19LCJjcmVkZW50aWFsU3ViamVjdCI6eyJkZWdyZWUiOnsibmFtZSI6IkJhY2hlbG9yIG9mIFNjaWVuY2UgYW5kIEFydHMiLCJfc2QiOlsiT3oxUEZIMG0tWk9TdEhwUVZyeGlmVlpKRzhvNmlQQmNnLVZ2SXQwd2plcyJdfSwiX3NkIjpbIkVZQ1daMTZZMHB5X1VNNzRHU3NVYU9zT19mdDExTlVSaFFUTS1TT1lFTVEiXX0sIl9zZCI6WyJqT055NnZUbGNvVlAzM25oSTdERGN3ekVka3d2R3VVRXlLUjdrWEVLd3VVIiwid21BdHpwc0dRbDJveS1PY2JrSEVZcE8xb3BoX3VYcWVWVTRKekF0aFFibyJdLCJfc2RfYWxnIjoic2hhLTI1NiIsImlzcyI6Imh0dHBzOi8vdW5pdmVyc2l0eS5leGFtcGxlL2lzc3VlcnMvNTY1MDQ5IiwiaWF0IjoxNjk3Mjg5OTk2LCJleHAiOjE3Mjg5MTIzOTYsImNuZiI6eyJqd2siOnsia3R5IjoiRUMiLCJjcnYiOiJQLTM4NCIsImFsZyI6IkVTMzg0IiwieCI6InZFdV84WGxZT0ZFU2hTcVRpZ2JSYWduZ0ZGM1p5U0xrclNHekh3azFBT1loanhlazVhV21HY2UwZU05S0pWOEIiLCJ5IjoiRUpNY2czWXBzUTB3M2RLNHlVa25QczE1Z0lsY2Yyay03dzFKLTNlYlBiOERENmQtUkhBeGUwMDkzSWpfdTRCOSJ9fX0.rYzbxb6j1dwop8_s491iArVVJNm6A6C3b742gOm_qYO3zdkyQU4_VxxOSJ8ECcmWj2r5KyiCNC1ojfO4Yms-zBsjt7PoMYpYWBplsqXpiIvnehmM7D0eOLi40uHXki0X~WyJTd2xuZFpPZzZEZ1ZERFp5X0RvYVFBIiwgInR5cGUiLCAiSnNvblNjaGVtYSJd~WyIxMjNNd3hNcHRiek02YUk2aW03ME1RIiwgInR5cGUiLCAiQmFjaGVsb3JEZWdyZWUiXQ~WyJMeG5GYTBXVm8wRUluVy1QdS1fd1dRIiwgInR5cGUiLCBbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwgIkV4YW1wbGVBbHVtbmlDcmVkZW50aWFsIl1d~WyJSWTg1YTZNMmEwX3VDWlFTVGZmTFdRIiwgImlkIiwgImh0dHA6Ly91bml2ZXJzaXR5LmV4YW1wbGUvY3JlZGVudGlhbHMvMTg3MiJd~eyJhbGciOiJFUzM4NCIsInR5cCI6ImtiK2p3dCJ9.eyJub25jZSI6IkVmeTROTFJPX3ZvSkszdDIzcUNfQlEiLCJhdWQiOiJodHRwczovL3ZlcmlmaWVyLmV4YW1wbGUiLCJpYXQiOjE2OTcyODk5OTZ9.6G-1nVcrDKFzR6BdbcFHcbtassEb8NZ7ZavTYz3SJ-e4pXleXs0tNcCkUCwMI70gsuOY0AXzeDPbHjp5GKyLDVuNWgWCt3Wo2VSaCwUkyfLyvhkCsmkF9kvFhMIOhp1i~
      </pre>
    </section>

    <section>
        <h2 id="cose-examples">COSE Examples</h2>
        <p>
            These examples rely on <a data-cite="RFC7049#section-6">CBOR Diagnostic Notation</a>.
            Remember that all actual interchange always happens in the binary format.
        </p>

        <pre class="example" title="A COSE Sign 1 Protected Header for a Verifiable Credential">
{                                   / Protected                     /
  1: -35,                           / Algorithm                     /
  3: application/vc,                / Content type                  /
  4: h'177f12cb...1933d554',        / Key identifier                /
  15: {                             / CWT Claims                    /
    1: urn:example:123,             / Issuer                        /
    2: urn:example:456,             / Subject                       /
  },
}
        </pre>

        <pre class="example" title="A COSE Sign 1 Protected Header for a Verifiable Presentation">
{                                   / Protected                     /
  1: -35,                           / Algorithm                     /
  3: application/vp,                / Content type                  /
  4: h'177f12cb...1933d554',        / Key identifier                /
  15: {                             / CWT Claims                    /
    1: urn:example:123,             / Issuer                        /
    2: urn:example:456,             / Subject                       /
  },
}
          </pre>

        <pre class="example" title="A COSE Sign 1 with an attached payload">
18(                                 / COSE Sign 1                   /
    [
      h'a4013822...3a343536',       / Protected Header              /
      {}                            / Unprotected Header            /
      h'0fbe22a0...3a009118',       / Attached payload              /
      h'09772c7f...5c4e736f'        / Signature                     /
    ]
)
      </pre>
        <p>
            The payload can be either a credential or presentation as described in
            <a data-cite="VC-DATA-MODEL-2.0#securing-mechanisms">Securing Mechanisms</a>.
        </p>
    </section>
</section>
  <section class="appendix informative">
    <h2>Acknowledgements</h2>

    <p>
The Working Group thanks Orie Steele for his substantive intellectual and content
contributions to this specification.  It wouldn't be the same without them.
    </p>
  </section>

</body>

</html>
